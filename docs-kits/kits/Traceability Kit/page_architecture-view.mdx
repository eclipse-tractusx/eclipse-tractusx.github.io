---
id: Architecture View Traceability Kit
title: Architecture View
description: 'Traceability Kit'
sidebar_position: 2
---

import Notice from './part_notice.mdx'
import NotificationSendReceive from './diagrams/part_notiifcation_send-receive.mdx'
import NotificationSendReceiveAlert from './diagrams/part_notification_send-receive-alert.mdx'
import NotificationUpdateInvestigation from './diagrams/part_notification_update-investigation.mdx'
import NotificationUpdateAlert from './diagrams/part_notification_update-alert.mdx'
import NotificationResolveInvestigation from './diagrams/part_notification_resolve-investigation.mdx'
import NotificationResolveAlert from './diagrams/part_notification_resolve-alert.mdx'

![Traceability kit banner](@site/static/img/doc-traceability_header-minified.png)
<!--
Architecture View of the Kit.
-->

The following page offers an architecture perspective including the main building blocks and information regarding communication between different components, shown as sequence diagrams in a runtime view.

The architectur of Traceability is built upon several other components of Catena-X. You need to be familiar with these components to understand the Traceability architecture:

- Industry Core for a basic understanding of digital twins and aspect models,
- Asset Administration Shell (AAS) as the underlying standard for digital twins,
- Digital Twin Registry (DTR) as the main service to store, publish, and search digital twins, and
- Eclipse Dataspace Connector (EDC) as the central data exchange infrastructure of Catena-X.

Additionally you might make yourself familiar with
- Item Relationship Service for traversing digital twin data chains based on the Data Chain Template,
- EDC Discovery for finding the EDC of a Catena-X partner, and
- SAMM as the modelling standard for aspect models.

<!-- !Mandatory! -->
<!-- ## Requirement / Understanding -->
<!-- ### System Scope and Context (Business & Technical Context) -->
<!-- #### Business Context -->
<!-- #### Technical Context -->

## Building Block View

This architecture overview only shows Catena-X Core Services that are directly accessed by Traceability components, e.g. the EDC is shown, but not the DAPS which is accessed by the EDC, but not directly by the Data Provisioning component.

![Architecture - Level 1](./assets/architecture_level_1.png)

### Traceability Components

| Subsystem         | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|:------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Data Provisioning | This component provides a company's data to the Catena-X network by transforming it into the Catena-X format and publishing it. In Catena-X, data must be provided to the network based on existing standards from the other Kits. One example that can be used is the Connector Kit that builds a component based on the DSP protocol, e.g. the Connector of the Eclipse Dataspace Components (EDC). As standard for digital twins, the Asset Administration Shell standard is used - this is relevant for registering digital twins (in the Digital Twin Registry) as well as for providing digital twin data. The data format used for Traceability data is based on the BAMM aspects models published in the Semantic Hub.                                                                                                   |
| Traceability App  | Enables traceability functionalities like quality alerts or notifications. When a Traceability App fetches data for digital twins (submodels), there are two options:<ul><li>Directly access the partner's EDC and DTR to connect to other partner's EDC and retrieve the data from ther</li><li>Use a local IRS service to get the data and let the IRS handle the EDC and DTR communication.</li></ul>                                                                                                                                                                                                                                                                                                                                                                                     |
| Internal Systems  | Existing internal systems of a Catena-X partner which provide data to Traceability components.<ul><li>For Data Provisioning: The data provided to Catena-X via the EDC should be fetched from a partner's internal PLM and parts master data systems.</li><li>For Traceability Apps: A Traceability App may show more data to a user than just the data that is provided to Catena-X (and fetched via the Data Provisioning component). The business scope of COTS software is bigger than just Traceability and they have existing interfaces to fetch all data they need for their business functionality (and not only Traceability data).</li></ul>Both components can also send data back to internal systems. That's at the discretion of the Catena-X partner and neither required nor prohibited by the Traceability use case. |

### Catena-X Core Services

| Subsystem                          | Description                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|:-----------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Digital Twin Registry              | The Digital Twin Registry acts as an address book for Digital Twins. Data Providers register their Digital Twins in their own Digital Twin Registry. Data consumers query the Digital Twin Registries to find Digital Twins and interact with them further. A Digital Twin contains endpoint references to Submodel endpoints. Calling a Submodel endpoint returns data compliant to a semantic model. A semantic model describes the data that a Submodel endpoint returns.<br/><br/>[Repository of the Digital Twin Registry](https://github.com/eclipse-tractusx/sldt-digital-twin-registry). |
| Item Relationship Service (IRS)    | The IRS is providing a technical API Endpoint in the Catena-X Network, which builds an item tree representation of given digital twins stored across the industry. Therefore it is a key component for the Network to provide data chains along the value chain in the industry.<br/><br/>[Repository of the IRS](https://github.com/eclipse-tractusx/item-relationship-service).                                                                                                                                                                                                        |
| Eclipse Dataspace Components (EDC) | The Connector of the Eclipse Dataspace Components provides a framework for sovereign, inter-organizational data exchange. It will implement the International Data Spaces standard as well as relevant protocols associated with GAIA-X. The connector is designed in an extensible way in order to support alternative protocols and integrate in various ecosystems.<br/><br/>[Repository of the Catena-X specific EDC](https://github.com/eclipse-tractusx/tractusx-edc).                                                                                                       |
| Discovery Service                  | The EDC / dataspace discovery interface is a CX network public available endpoint which can get used to retrieve EDC endpoints and the related BPNs, as well as search for endpoints via the BPN.    |

## Data Provisioning

- Digital Twins
    - Digtial Twin "PartType"
    - Digtial Twin "PartInstance"

- Traceability data aspect models
    - Aspect model "SingelLevelUsageAsPlanned"
    - Aspect model "TractionBatteryCode"

## Traceability App

The objective of this section is to define what mandatory features a Traceability app must provide and how to implement them to be interoperable with other Traceability apps. Additionally, optional features of Traceability apps are also included. This information is used by software vendors to develop Traceability-compliant apps for Catena-X.

### Functional Requirements

| Requirement | Mandatory | Description |
| :-- | :--: |:-- |
| Digital Twin PartInstance	| Yes | For Release 2, the Traceability app must be able to visualize BoM As-Built data. This data will also be used by Quality Investigations & Alert features, so it's essential for a Traceability app. The data for the manufacturer's parts is retrieved from the manufacturer's internal systems; the data for built-in parts from suppliers must be retrieved from the supplier's EDC as this is a cross-company data transfer (if necessary).<br/>The data for the manufacturer's parts can be retrieved from a company's internal systems:<ul><li>via a dedicated interface for the Traceability app</li><li>via the EDC using the data also provided to other partner's in the Catena-X ecosystem</li></ul>It is not mandatory to use EDC to retrieve this data as this is not a cross-company data transfer, but a data transfer from one application of the company to another application of the company. Advantages and disadvantages of getting the data from the EDC compared to using a dedicated interface, see the example discussion of this matter in context of the Trace-X solution: (TRS) Decision: Trace-X: Dedicated Interface for Company Data.<br/>It is at the discretion of the Traceability app vendor which option they choose. |
| Data Exchange via EDC	| Yes | The data exchange with other Catena-X partners (for Traceability partners, these are their customers and suppliers mostly) must be done via EDC. |
| Data Sovereignty | Yes | The usage of data in the Traceability app is compliant with the Access and Usage Policies as defined in Traceability KIT.
| Quality Alerts | No | In the event of an incident the partner's value chain, the partner would like to be informed promptly and in a structured manner by the triggering partners (e.g., manufacturing problem, field problems) so that the partner can respond as quickly as possible (Supplier/Customer). In the same way, the partner wants to inform their value chain partners easily and specifically in the event of relevant incidents. The traceability apps are able to exchange the alerts in the same interoperable way. | 
| Quality Investigations | Yes | For a given incident in a partner's supply chain, the partner would like to be able to narrow down the affected products as sharply as possible in order to carry out suitable actions in a targeted manner. The partners in the value chain use interoperable Traceability apps for this purpose.|

### Non-Functional Requirements

There are no non-functional requirements defined for this release.

### Quality Alerts & Quality Investigations

Notifications are - in contrast to classical data offers - a way to push data from a sender to a receiver. In the below paragraphs, the implementation is described to realize quality notifications. In that sense, the below specification has not the scope and intention to be a general solution pattern for notifications across various use cases. For now, it is limited to the sending and receiving of quality notifications as well as the update of the notification status (following a predefined status model).

#### Notification State Model 

Notifications always have a status. The transition from one status to a subsequent status is described in the below state model.

> :raised_hand: The Sender can change the status to CLOSED from any status. The receiver can never change the status to CLOSED.

The legend in the below state diagram describes who can set the status. One exception from this rule: the transition from status SENT to status RECEIVED is not done with a separate Http POST update call from the receiver. Rather, this status transition is implicitly done once the Sender receives the Http status code 201 after the initial Http POST to send/receive the notification.

### Resolution of a Quality Notification

The resolution is an optional feature, which MAY be implemented by a traceability application. It is an information that helps an end user working with quality notifications to know how a quality notification has been resolved. Especially, with the resolution it is possible for an end user to know the resolution for an already closed quality notification.

The resolution is an information attached to a quality notification and can have the following values:
- OPEN
- ACCEPTED
- DECLINED
- ABORTED

The above mentioned values are automatically set with each status transition as defined in the notification state model. The following table defines the values of the resolution based on those status transitions:

| Start Status | End Status | Resolution Value |
| :-- | :-- | :-- |
| None	| CREATED	| OPEN |
| CREATED	| SENT	| OPEN |
| SENT	| RECEIVED	| OPEN |
| RECEIVED	| ACKNOWLEDGED	| OPEN |
| ACKNOWLEDGED	| ACCEPTED	| ACCEPTED |
| ACKNOWLEDGED	| DECLINED	| DECLINED |
| ACCEPTED	| CLOSED	| ACCEPTED |
| DECLINED	| CLOSED	| DECLINED |
| ACKNOWLEDGED	| CLOSED	A| BORTED |
| RECEIVED	| CLOSED	| ABORTED |
| SENT	| CLOSED	| ABORTED |
| CREATED	| LOSED	| ABORTED |

## Runtime View

_Detail runtime views including specific sequence diagrams will follow in the near future._

### Processes for Sending, Updating and Resolving Notifications

Below the sequence for sending, updating and resolving of notifications between (traceability) applications is shown with UML sequence diagrams. In all cases, Http POST requests are used. Those Http endpoints are described in the section (TRS) Quality Notification Endpoints and EDC Contract Offerings.

To read the UML sequence diagrams correctly, some remarks:

- The shown Notification EDC Adapter is not mandatory. It is just one option to send a notification via the EDC control and data plane. Important is that a similar functionality must be provided/implemented by the (traceability) application vendor. The Notification EDC Adapter or a similar component / functionality will not be provided as a central service from Catena-X.
- To know where a notification must be send to, the (traceability) application must resolve the BPN of the receiver. This can either be happen because the (traceability) application has this information in its data model or it could - alternatively - also be resolved e.g. via a lookup of the digital twin in the central asset administration shell (AAS) registry.

  :raised_hand: The (traceability) applications that fully rely on the AAS registry and the corresponding AAS submodels can only support quality investigations. With the release of the AAS submodel SingleLevelUsageAsBuilt or a similar AAS submodel that contains the information, which supply chain partner purchased/assembled a part / batch, it is possible to also support quality alerts for those (traceability) applications. (Warnung)
- The resolution of the EDC URL for a given BPN is done via the Discovery Service API. The entry for each EDC into this Discovery Service is done via the CX Portal.
- In each UML sequence diagram the step [01] describes the publishing of the notification endpoints as described in the above sections
- Similarly, the Http POST request and response bodies are described in the above sections

<NotificationSendReceive components={props.components} />

<NotificationSendReceiveAlert components={props.components} />

<NotificationUpdateInvestigation components={props.components} />

<NotificationUpdateAlert components={props.components} />

<NotificationResolveInvestigation components={props.components} />

<NotificationResolveAlert components={props.components} />

<!-- !Mandatory! -->
## Standards

Our relevant standards can be downloaded from the official [Catena-X Standard Library](https://catena-x.net/de/standard-library):

- [CX - 0018 Sovereign Data Exchange](https://catena-x.net/de/standard-library)
- [CX - 0019 Aspect Model: Serial Part](https://catena-x.net/fileadmin/user_upload/Standard-Bibliothek/Update_PDF_Maerz/PLM_Quality_Use_Case_Traceability/CX_-_0019_SerialPart_UseCaseTraceability_v_1.0.1.pdf)
- [CX - 0020 Aspect Model: Single Level BoMAsBuilt](https://catena-x.net/fileadmin/user_upload/Standard-Bibliothek/Update_PDF_Maerz/PLM_Quality_Use_Case_Traceability/CX_-_0020_SingleLevelBomAsBuilt_UseCaseTraceability_v_1.0.1.pdf)
- [CX - 0021 Aspect Model: Batch](https://catena-x.net/fileadmin/user_upload/Standard-Bibliothek/Update_PDF_Maerz/PLM_Quality_Use_Case_Traceability/CX_-_0021__Batch_UseCaseTraceability_v_1.0.1.pdf)
- [CX - 0022 Notification Process](https://catena-x.net/fileadmin/user_upload/Standard-Bibliothek/Update_PDF_Maerz/PLM_Quality_Use_Case_Traceability/CX_-_0022_Notification_Process_v_1.1.1.pdf)
- [CX - 0023 Notification API](https://catena-x.net/fileadmin/user_upload/Standard-Bibliothek/Update_PDF_Maerz/PLM_Quality_Use_Case_Traceability/CX_-_0023_Notification_API_v_1.1.1.pdf)
- [CX - 0042 Aspect Model: Single Level BomAsPlanned](https://catena-x.net/fileadmin/user_upload/Standard-Bibliothek/Update_PDF_Maerz/PLM_Quality_Use_Case_Traceability/CX_-_0042_Semantic_Model_Single_Level_BomAsPlanned_v_1.0.1.pdf)
- [CX - 0043 Semantic Model: Part AsPlanned](https://catena-x.net/fileadmin/user_upload/Standard-Bibliothek/Update_PDF_Maerz/PLM_Quality_Use_Case_Traceability/CX_-_0043_Semantic_Model_PartAsPlanned_v_1.0.1.pdf)
- [CX - 0093 Aspect Model TractionBatteryCode](https://catena-x.net/de/standard-library)
- [CX - 0094 Aspect Model Part Site Information AsPlanned](https://catena-x.net/de/standard-library)

<Notice components={props.components} />

