"use strict";(self.webpackChunkeclipse_tractusx_github_io=self.webpackChunkeclipse_tractusx_github_io||[]).push([["26307"],{618915:function(e,t,n){n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});var i=n(30022),s=n(474848),a=n(884429);let o={id:"software-development-view",title:"Developing with the DT KIT",description:"Digital Twin KIT - Software Development View",sidebar_position:1},r,d={},l=[{value:"Architecture Overview",id:"architecture-overview",level:2},{value:"API Specifications",id:"api-specifications",level:2},{value:"Asset Administration Shell",id:"asset-administration-shell",level:3},{value:"Submodels",id:"submodels",level:4},{value:"Digital Twin Registry",id:"digital-twin-registry",level:4},{value:"Catena-X specific Services",id:"catena-x-specific-services",level:3},{value:"Sample Data",id:"sample-data",level:2},{value:"Registration at Digital Twin Registry",id:"registration-at-digital-twin-registry",level:3},{value:"Registering a new Twin",id:"registering-a-new-twin",level:4},{value:"Registering a new Submodel at an existing Twin",id:"registering-a-new-submodel-at-an-existing-twin",level:4},{value:"Registration at EDC",id:"registration-at-edc",level:3},{value:"Digital Twin Registry as EDC Data Asset",id:"digital-twin-registry-as-edc-data-asset",level:4},{value:"Submodel as EDC Data Asset",id:"submodel-as-edc-data-asset",level:4},{value:"Usage Policies",id:"usage-policies",level:3},{value:"Data Provisioning",id:"data-provisioning",level:2},{value:"Regulatory Compliance and Security",id:"regulatory-compliance-and-security",level:3},{value:"Versioning",id:"versioning",level:3},{value:"Patterns for Submodel Deployment",id:"patterns-for-submodel-deployment",level:3},{value:"Patterns for DTR Deployment",id:"patterns-for-dtr-deployment",level:3},{value:"Notice",id:"notice",level:2}];function c(e){let t={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"DT Kit Pictotogram",src:n(231449).A+"",width:"264",height:"245"})}),"\n",(0,s.jsx)(t.h2,{id:"architecture-overview",children:"Architecture Overview"}),"\n",(0,s.jsxs)(t.p,{children:["The interplay of the Digital Twin Kit's components can be found in\nthe ",(0,s.jsx)(t.a,{href:"/docs-kits/next/kits/digital-twin-kit/software-operation-view",children:"Operation View"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"api-specifications",children:"API Specifications"}),"\n",(0,s.jsxs)(t.p,{children:["All openAPI-specifications for the Digital Twin Kit services are stored in the ",(0,s.jsx)(t.a,{href:"https://github.com/eclipse-tractusx/eclipse-tractusx.github.io/tree/main/openApi/dt",children:"openApi section"})," of this repo.\nPlease note that these are non-normative replicas from the original standards and their normative references."]}),"\n",(0,s.jsx)(t.h3,{id:"asset-administration-shell",children:"Asset Administration Shell"}),"\n",(0,s.jsxs)(t.p,{children:["The Asset Administration Shell (AAS) is a specification that is released by\nthe ",(0,s.jsx)(t.a,{href:"https://industrialdigitaltwin.org/",children:"Industrial Digital Twin Association (IDTA)"}),"\nand already partly adopted by the ",(0,s.jsx)(t.a,{href:"https://www.iec.ch/homepage",children:"International Electrotechnical Commission (IEC)"})," as\n",(0,s.jsx)(t.a,{href:"https://webstore.iec.ch/en/publication/65628",children:"IEC 63278"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Its mission is defining how \u201Cinformation about assets [\u2026] can be exchanged in a meaningful way between partners in a\nvalue creation network\u201D (",(0,s.jsx)(t.a,{href:"https://industrialdigitaltwin.org/wp-content/uploads/2023/04/IDTA-01001-3-0_SpecificationAssetAdministrationShell_Part1_Metamodel.pdf",children:"IDTA 01001-3-0"}),"\n, p.12) . As such, it is well-suited to contribute to the toolbox of Catena-X. While the Spec offers an\nextensive suite of meta-model elements and APIs, Catena-X only mandates a small subset that is defined in CX - 0002."]}),"\n",(0,s.jsx)(t.h4,{id:"submodels",children:"Submodels"}),"\n",(0,s.jsxs)(t.p,{children:["An Asset Administration Shell is organized in Submodels. Each Submodel represents a self-contained aspect of an asset -\ntypical examples are the ",(0,s.jsx)(t.em,{children:"PartAsPlanned"})," or ",(0,s.jsx)(t.em,{children:"SingleLevelBomAsBuilt"})," (which denotes the hierarchical composition of\nparts into a whole). All relevant Submodels for Catena-X can be are built from SAMM models and can be found on ",(0,s.jsx)(t.a,{href:"https://github.com/eclipse-tractusx/sldt-semantic-models/",children:"Github"}),".\nAs different aspects of an Asset may be known to different parties on the value-chain, Submodels\nfor a single asset must be capable to run independently of each other. The specification explicitly allows this,\nenabling easy cross-company data integration."]}),"\n",(0,s.jsxs)(t.p,{children:["Recognizing that not all use-cases require the full functionality of the AAS-Spec, Catena-X demands that Data\nProviders offer only a subset of the SubmodelServiceSpecification - namely the ",(0,s.jsx)(t.code,{children:"$value"})," serialization. This is an\nabbreviated notation of an AAS-Submodel that is focused on data instead of context. While it is advisable to expose\nSubmodels with help of a full-fletched AAS-server SDK that provides the content-modifiers and API-endpoints\nout-of-the-box, this is not yet mandatory."]}),"\n",(0,s.jsx)(t.h4,{id:"digital-twin-registry",children:"Digital Twin Registry"}),"\n",(0,s.jsxs)(t.p,{children:['What Catena-X calls the "Digital Twin Registry" (DTR) is actually the union of two different services that the AAS\nspecification\nhas specified. For the sake of simplicity, they are both defined in a single component. The DTR serves a similar\nfunction as the\nindex in a book: When trying to discover information, it\'s convenient to have an overview WHAT one will find, HOW and\nWHERE to\naccess it. The registry caters exactly that information: For every asset it knows, it holds a number of Submodel\nDescriptors and in\nthese, a consumer app will find information what it will find (via the semanticId) and how to access the information (\nendpoint,\nsecurity setup etc.). As the information contained in the DTR may be sensitive and not be trusted with a central entity,\nevery data provider must offer his own DTR as an EDC Data Asset. While it is only mandatory to implement the GET\nendpoints\nas specified in\nthe ',(0,s.jsx)(t.a,{href:"https://catenax-ev.github.io/docs/next/standards/CX-0002-DigitalTwinsInCatenaX",children:"Standard CX-0002"}),",\ndata providers may find it useful to implement other requests for registration\non top. Either way, they are free to populate their DTR in any way they desire."]}),"\n",(0,s.jsx)(t.h3,{id:"catena-x-specific-services",children:"Catena-X specific Services"}),"\n",(0,s.jsxs)(t.p,{children:["DTRs hold sensitive information: a submodel-descriptor may not give access to the actual Submodel-data but all in cumulo\nhint at\nproduction volumes as each Twin represents an asset. Therefore, Catena-X implements decentral DTRs (DDTR), each running\nwith a\nbusiness partner.\n",(0,s.jsx)(t.a,{href:"https://industrialdigitaltwin.org/en/wp-content/uploads/sites/2/2023/06/Decentralized-Registries-Taxonomy-of-decentralized-registries-and-an-architectural-overview_.pdf",children:"In an IDTA-Whitepaper"}),",\nseveral high-level concepts for DDTRs are introduced. The AAS-specification remains agnostic to the approaches and\nendorses\nnone of them. Catena-X must deal with the additional complexity that stems from the interaction with the EDC."]}),"\n",(0,s.jsxs)(t.p,{children:["Leveraging the native capabilities of the EDC and the EDC Discovery Service, Catena-X uses a discovery pattern that has\nthe same capability as a central ",(0,s.jsx)(t.a,{href:"#digital-twin-registry",children:"Digital Twin Registry"})," would:\nIt allows to start a Discovery Process with only an assetId and its type (like ",(0,s.jsx)(t.code,{children:"manufacturerPartId"}),").\nHowever, in Catena-X some of the data is deemed so sensitive that a central authority can't be\ntrusted with it. Thus, a decentralized approach is implemented: each Data Provider will run their own DTR.\nThis poses a challenge for discovery if the BPN of the supplier is not known by the data consumer. After all, a\nData Consumer must still find out the address where to fetch the data from. That's why Catena-X has introduced a\nthree-step discovery pattern made up of the central microservices Discovery Finder, BPN Discovery (or several of them)\nand finally the EDC discovery that is part of the CX-Portal.\nThe Discovery Finder and the BPN Discovery service are described as part of this Kit."]}),"\n",(0,s.jsx)(t.h2,{id:"sample-data",children:"Sample Data"}),"\n",(0,s.jsx)(t.p,{children:"Generic sample data for relevant data objects is contained in the openAPI-specs of the respective services. This chapter\ncontains data structures that are more specifically designed for use in the Digital Twin Kit. They are compliant with\nthe base-specifications (like AAS) but restrict the application even further for use in this Dataspace."}),"\n",(0,s.jsx)(t.h3,{id:"registration-at-digital-twin-registry",children:"Registration at Digital Twin Registry"}),"\n",(0,s.jsxs)(t.p,{children:["The Digital Twin Registry connects an asset (identified by its assetIds) with links to the Submodels. Since Catena-X\nuses the EDC as a gateway for all inter-company interaction, the Digital Twin Registry must account for that. By\ndesign, it includes the possibility to add additional context via the fields ",(0,s.jsx)(t.code,{children:"subprotocol"}),", ",(0,s.jsx)(t.code,{children:"subprotocolBody"})," and\n",(0,s.jsx)(t.code,{children:"subprotocolEncoding"}),". ",(0,s.jsx)(t.code,{children:"subprotocol"})," will always be set to ",(0,s.jsx)(t.code,{children:"DSP"}),", short for the ",(0,s.jsx)(t.a,{href:"https://docs.internationaldataspaces.org/ids-knowledgebase/v/dataspace-protocol/overview/readme",children:"Dataspace Protocol"})," as\nstandardized by the IDSA. ",(0,s.jsx)(t.code,{children:"subprotocolEncoding"}),"  is always set to ",(0,s.jsx)(t.code,{children:"plain"}),"."]}),"\n",(0,s.jsx)(t.p,{children:"There's three relevant inputs to discover a referenced Submodel in Catena-X:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"subprotocolBody"})," contains two pieces of information, assigned with ",(0,s.jsx)(t.code,{children:"="})," and separated by ",(0,s.jsx)(t.code,{children:";"}),":"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.em,{children:(0,s.jsx)(t.code,{children:"dspEndpoint"})})," is the URL of the Control Plane where a Data Consumer can negotiate for access to this Submodel. For\nmany\nconnector-implementations, this will end on ",(0,s.jsx)(t.code,{children:"/api/v1/dsp"}),". As this property will be used in the discovery sequence\nto construct a ",(0,s.jsx)(t.code,{children:"catalog"}),"-request, this variable is equivalent to the ",(0,s.jsx)(t.code,{children:"<base>"}),"\nin ",(0,s.jsx)(t.a,{href:"https://docs.internationaldataspaces.org/ids-knowledgebase/v/dataspace-protocol/catalog/catalog.binding.https#id-2.1-prerequisites",children:"this example"}),"\nin the DSP-spec."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["When calling the /catalog API of that Control Plane, a Consumer should filter for ",(0,s.jsx)(t.code,{children:"dcat:Dataset"})," entries that are\nidentified by the ",(0,s.jsx)(t.em,{children:(0,s.jsx)(t.code,{children:"id"})})," mentioned in the ",(0,s.jsx)(t.code,{children:"subprotocolBody"}),". For communication between two EDCs, the Consumer could\nquery with the following payload:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n"@context": {\n    "edc": "https://w3id.org/edc/v0.0.1/ns/"\n},\n"@type": "CatalogRequest",\n"counterPartyAddress": "{{provider-dsp-endpoint}}",\n"protocol": "dataspace-protocol-http",\n"querySpec": {\n    "offset": 0,\n    "limit": 50,\n    "filterExpression": [\n        {\n            "@context": {\n                "edc": "https://w3id.org/edc/v0.0.1/ns/"\n            },\n            "@type": "edc:Criterion",\n            "operandLeft": "https://w3id.org/edc/v0.0.1/ns/id",\n            "operator": "=",\n            "operandRight": "{{assetId}}"\n        }\n    ]\n  }\n}\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["After having successfully negotiated for a Data Offer associated with the ",(0,s.jsx)(t.code,{children:"id"}),", the Data Consumer can query the Data\nPlane of the given EDC to access the data. For that, the Provider must use the URL given in the Submodel-Descriptor's\n",(0,s.jsx)(t.code,{children:"href"})," field and append the additional URL-segment ",(0,s.jsx)(t.code,{children:"/$value"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["In some circumstances (such as the ",(0,s.jsx)(t.a,{href:"/docs-kits/next/kits/product-carbon-footprint-exchange-kit/software-development-view#payload-for-requesting-pcf-sub-model",children:"PCF Kit"}),")\nthe ",(0,s.jsx)(t.code,{children:"submodelDescriptors[i]/endpoints[j]/interface"})," property may be used to signify that the payload of the Submodel\nmust be retrieved using an API that's not the subset of Submodel-API defined in CX-0002. This leaves the scope of the\nDT Kit and must be specified by subsequent standards."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"A full example on the default case is shown in the next section."}),"\n",(0,s.jsx)(t.h4,{id:"registering-a-new-twin",children:"Registering a new Twin"}),"\n",(0,s.jsxs)(t.p,{children:["Registration of a new twin is (at least in Catena-X) equivalent to the creation of a new twin. Thus, a Data Provider\nshould always ensure that there is no AAS-descriptor created for the respective assetIds yet. If there already is one,\nthe submodel-descriptor should\nbe ",(0,s.jsx)(t.a,{href:"#registering-a-new-submodel-at-an-existing-twin",children:"added to the existing shell-descriptor"}),"."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"POST /shell-descriptors"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "id": "urn:uuid:e5c96ab5-896a-1234-8761-efd74777ca97",\n  "idShort": "myAas",\n  "specificAssetIds": [\n    {\n      "name": "manufacturerPartId",\n      "value": "123-345-567103",\n      "externalSubjectId": {\n        "type": "ExternalReference",\n        "keys": [\n          {\n            "type": "GlobalReference",\n            "value": "{{BPN of the party privileged}}"\n          }\n        ]\n      }\n    }\n  ],\n  "submodelDescriptors": [\n    {\n      "id": "e5c96ab5-896a-482c-8761-efd74777ca97",\n      "semanticId": {\n        "type": "ExternalReference",\n        "keys": [\n          {\n            "type": "GlobalReference",\n            "value": "urn:bamm:io.catenax.material_for_recycling:1.1.0#MaterialForRecycling"\n          }\n        ]\n      },\n      "endpoints": [\n        {\n          "interface": "SUBMODEL-3.0",\n          "protocolInformation": {\n            "href": "https://edc.data.plane/mypath/submodel",\n            "endpointProtocol": "HTTP",\n            "endpointProtocolVersion": [\n              "1.1"\n            ],\n            "subprotocol": "DSP",\n            "subprotocolBody": "id=123;dspEndpoint=http://edc.control.plane/api/v1/dsp",\n            "subprotocolBodyEncoding": "plain",\n            "securityAttributes": [\n              {\n                "type": "NONE",\n                "key": "NONE",\n                "value": "NONE"\n              }\n            ]\n          }\n        }\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(t.h4,{id:"registering-a-new-submodel-at-an-existing-twin",children:"Registering a new Submodel at an existing Twin"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.code,{children:"POST /shell-descriptors/{{aasId}}"})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "id": "e5c96ab5-896a-482c-8761-efd74777ca97",\n  "semanticId": {\n    "type": "ExternalReference",\n    "keys": [\n      {\n        "type": "GlobalReference",\n        "value": "urn:bamm:io.catenax.material_for_recycling:1.1.0#MaterialForRecycling"\n      }\n    ]\n  },\n  "endpoints": [\n    {\n      "interface": "SUBMODEL-3.0",\n      "protocolInformation": {\n        "href": "https://edc.data.plane/mypath/submodel",\n        "endpointProtocol": "HTTP",\n        "endpointProtocolVersion": [\n          "1.1"\n        ],\n        "subprotocol": "DSP",\n        "subprotocolBody": "id=123;dspEndpoint=http://edc.control.plane/api/v1/dsp",\n        "subprotocolBodyEncoding": "plain",\n        "securityAttributes": [\n          {\n            "type": "NONE",\n            "key": "NONE",\n            "value": "NONE"\n          }\n        ]\n      }\n    }\n  ]\n}\n\n'})}),"\n",(0,s.jsx)(t.h3,{id:"registration-at-edc",children:"Registration at EDC"}),"\n",(0,s.jsx)(t.p,{children:"Integration between the EDC and AAS-Components in the dataspace is a strict prerequisite for robust discovery and data\naccess in the Catena-X dataspace. As all data that crosses company-boundaries must be exchanged via an EDC, CX-0002\nprovides the necessary normative statements to facilitate interoperable data exchange."}),"\n",(0,s.jsx)(t.p,{children:"One relevant question is how the EDC-shielded services of this Kit should register with the Asset endpoint of the EDC\nManagement API. While the EDC's /v3/assets endpoint is internal to the Data Provider only, the objects are also\navailable via the /catalog API that is specified in the Dataspace Protocol."}),"\n",(0,s.jsxs)(t.p,{children:["The EDC uses json-ld. Json-ld is a serialization for RDF graphs (see ",(0,s.jsx)(t.a,{href:"https://www.w3.org/RDF/",children:"Resource Description Framework"}),").\nThe json-ld ",(0,s.jsx)(t.code,{children:"@context"})," section can declare the namespaces that resources explicitly mentioned in the rest of the\ndocument belong to. It may also define default namespace with ",(0,s.jsx)(t.code,{children:"@vocab"}),' for resources without explicitly stated\nnamespaces. Outside of the "@context" section, the ',(0,s.jsx)(t.code,{children:"@type"})," property always defines the class that an object belongs to.\nAs stated in the openAPI-specification of the EDC Management API's relevant endpoint, all entries in the\n",(0,s.jsx)(t.code,{children:"properties"})," object and the ",(0,s.jsx)(t.code,{children:"privateProperties"})," object can be chosen freely. The section on the ",(0,s.jsx)(t.code,{children:"dataAddress"})," is\nstructured depending on the ",(0,s.jsx)(t.code,{children:"edc:type"})," property. The example below is determined by the ",(0,s.jsx)(t.a,{href:"https://github.com/eclipse-edc/Connector/blob/main/spi/common/core-spi/src/main/java/org/eclipse/edc/spi/types/domain/HttpDataAddress.java",children:"HttpDataAddress"}),"\nclass. Its parameters determine the behavior of the EDC's HTTP data plane at runtime. How they should be used is not\nsubject to standardization since they aren't visible in the Dataspace. Certain values may have to be set in a certain\nway to enable the data exchange via the DT Kit."]}),"\n",(0,s.jsxs)(t.p,{children:["It presents the backend resources as ",(0,s.jsx)(t.code,{children:"dcat:Dataset"}),"s with properties funnelled through from the assets-API. These\nproperties can be freely set by the Data Provider."]}),"\n",(0,s.jsxs)(t.p,{children:["For successful discovery of Digital Twins, it is critical to register Submodels and Digital-Twin-Registries in a\nharmonized way. The following overview shall explain how the ",(0,s.jsx)(t.code,{children:"properties"})," section could be used."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"http://purl.org/dc/terms/type"})," (mandatory as per CX-0018): denotes the type of Asset that is registered. The\nproperty\npoints to an RDF resource. In the context of digital twins two predefined resources are of\nrelevance: ",(0,s.jsx)(t.code,{children:"https://w3id.org/catenax/taxonomy#DigitalTwinRegistry"})," and ",(0,s.jsx)(t.code,{children:"https://w3id.org/catenax/taxonomy#Submodel"})]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.code,{children:"https://w3id.org/catenax/common/version"}),' (mandatory as per CX-0002): version-string of the registered type of\nresource.\nFor all endpoints related to the AAS-spec, this must be set to "3.0" as that\'s the current normative version of the\nAAS specification.']}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h4,{id:"digital-twin-registry-as-edc-data-asset",children:"Digital Twin Registry as EDC Data Asset"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "@context": {\n    "edc": "https://w3id.org/edc/v0.0.1/ns/",\n    "cx-common": "https://w3id.org/catenax/ontology/common#",\n    "cx-taxo": "https://w3id.org/catenax/taxonomy#",\n    "dct": "http://purl.org/dc/terms/"\n  },\n  "@id": "{{ _.edcAssetId }}",\n  "properties": {\n    "dct:type": {\n      "@id": "cx-taxo:DigitalTwinRegistry"\n    },\n    "cx-common:version": "3.0"\n  },\n  "privateProperties": {\n  },\n  "dataAddress": {\n    "@type": "DataAddress",\n    "type": "HttpData",\n    "baseUrl": "{{ _.url_backend }}",\n    "proxyQueryParams": "true",\n    "proxyPath": "true",\n    "proxyMethod": "false",\n    "oauth2:tokenUrl": "{{ _.url_keycl_backend }}",\n    "oauth2:clientId": "{{ _.client_id_backend }}",\n    "oauth2:clientSecretKey": "{{ _.sec_name_vault }}"\n  }\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["The property ",(0,s.jsx)(t.code,{children:"asset:prop:type"})," (deprecated and superseded by ",(0,s.jsx)(t.code,{children:"dct:type"})," - see CX-0002) denotes the type of Asset that\nis registered. For all DTRs this property had be set to ",(0,s.jsx)(t.code,{children:"data.core.digitalTwinRegistry"}),". Providers may keep\nthis redundant property for backward compatibility purposes."]}),"\n",(0,s.jsx)(t.p,{children:"The HttpDataAddress above configures the following behavior:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"baseUrl"}),": After successful negotiation, the data plane will delegate requests here and forward the answer. For the\nDTR,\nit's critical that the URL inserted here must end before the /shell-descriptors and /lookup segments."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"proxyPath"}),': This string can be either "true" or "false". If set to true, the EDC Data Plane will always forward\nthe URL-segments added to the request to the dataplane to the backend URL. For example:\nIf ',(0,s.jsx)(t.code,{children:'baseUrl="http://mydtr.com/api/v3"'}),"\nand ",(0,s.jsx)(t.code,{children:'proxyPath="true"'})," then an authorized request to ",(0,s.jsx)(t.code,{children:"http://dataplane.com/shell-descriptors"})," will be delegated to the\nbackend\n",(0,s.jsx)(t.code,{children:"http://mydtr.com/api/v3/shell-descriptors"})]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"proxyQueryParams"}),': This string can be either "true" or "false". If set to true, the EDC Data Plane will always\nforward query parameters to the backend. For the /lookup APIs of the registry, this is critical.']}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"proxyMethod"}),': This string can be either "true" or "false". If "false", the Data Plane will change the HTTP-Verb to\nGET for all incoming requests. As there is no scenario in the Catena-X scope where a business partner manipulates\ndata in a foreign DTR, it should be set to false.']}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["If a Data Consumer wants to filter a Data Provider's catalog (assuming both use an EDC-based connector), the following\npayload can be used against the EDC Management API's ",(0,s.jsx)(t.code,{children:"POST /catalog/request"})," endpoint:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "@context": {\n    "edc": "https://w3id.org/edc/v0.0.1/ns/"\n  },\n  "@type": "CatalogRequest",\n  "counterPartyAddress": "{{PROVIDER-DSP-ENDPOINT}}",\n  "protocol": "dataspace-protocol-http",\n  "querySpec": {\n    "offset": 0,\n    "limit": 50,\n    "filterExpression": [\n      {\n        "@context": {\n          "edc": "https://w3id.org/edc/v0.0.1/ns/"\n        },\n        "@type": "edc:Criterion",\n        "operandLeft": "\'http://purl.org/dc/terms/type\'.\'@id\'",\n        "operator": "=",\n        "operandRight": "https://w3id.org/catenax/taxonomy#DigitalTwinRegistry"\n      }\n    ]\n  }\n}\n'})}),"\n",(0,s.jsx)(t.h4,{id:"submodel-as-edc-data-asset",children:"Submodel as EDC Data Asset"}),"\n",(0,s.jsxs)(t.p,{children:["A Data Provider may create one Data Asset per Submodel or bundle them into one - yielding a smaller catalogue hence\nbetter performance. The discovery-sequence does not strictly require uniformity here. Not even the typization via the\nEDC-property ",(0,s.jsx)(t.code,{children:"dct:type"})," is functionally necessary. The discovery-sequence is still intact since a Data Consumer will\nalways know the Submodel's location relative to the Data Plane's ",(0,s.jsx)(t.code,{children:"baseUrl"})," from the submodel-descriptor's ",(0,s.jsx)(t.code,{children:"href"})," field.\nThe EDC-Asset shielding the Submodel is known from the descriptor's ",(0,s.jsx)(t.code,{children:"subprotocolBody"})," containing the Control-Plane-URL\nand id of the EDC-Asset. For more details, see section ",(0,s.jsx)(t.a,{href:"#registration-at-digital-twin-registry",children:"Submodel Descriptor in the Digital Twin Registry"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["The following shows an example for registration of a single AAS-Submodel as EDC Data Asset. The\n",(0,s.jsx)(t.code,{children:"properties"})," section is analogous to that of the DTR but additionally holds ",(0,s.jsx)(t.code,{children:"hasSemantics:semanticId"})," with the\n",(0,s.jsx)(t.code,{children:"hasSemantics"}),"-prefix resolving to ",(0,s.jsx)(t.code,{children:"https://admin-shell.io/aas/3/0/HasSemantics/"}),". It is recommended and shall signify\nthe meaning of the Submodel's payload."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "@context": {\n    "edc": "https://w3id.org/edc/v0.0.1/ns/",\n    "cx-common": "https://w3id.org/catenax/ontology/common#",\n    "cx-taxo": "https://w3id.org/catenax/taxonomy#",\n    "dct": "http://purl.org/dc/terms/",\n    "aas-semantics": "https://admin-shell.io/aas/3/0/HasSemantics/"\n  },\n  "@id": "{{ _.assetId }}",\n  "properties": {\n    "dct:type": {\n      "@id": "cx-taxo:Submodel"\n    },\n    "cx-common:version": "3.0",\n    "aas-semantics:semanticId": {\n      "@id": "urn:bamm:io.catenax.asset_tracker_links:1.0.0#AssetTrackerLinks"\n    }\n  },\n  "privateProperties": {\n  },\n  "dataAddress": {\n    "@type": "DataAddress",\n    "type": "HttpData",\n    "baseUrl": "{{ _.url_backend }}",\n    "oauth2:tokenUrl": "{{ _.url_keycl_backend }}",\n    "oauth2:clientId": "{{ _.client_id_backend }}",\n    "oauth2:clientSecretKey": "{{ _.sec_name_vault }}",\n    "proxyQueryParams": "false",\n    "proxyPath": "true",\n    "proxyMethod": "false"\n  }\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["There is no normative guidance  on how to register multiple Submodels bundled together yet. These bundles may include\nall the Submodels of a specific semanticId, all Submodels of an asset or any other arbitrary quality. This may be added\nto CX-0002 in future iterations. Even though the IDTA specifies a ",(0,s.jsx)(t.a,{href:"https://app.swaggerhub.com/apis/Plattform_i40/SubmodelRepositoryServiceSpecification/V3.0.1_SSP-002",children:"Submodel Repository API"}),", in the context of the\nCatena-X architecture it is not strictly necessary to adhere to it. Submodels will be found regardless,\ngiven the URL-path relative to the ",(0,s.jsx)(t.code,{children:"baseUrl"})," is appended correctly to the Data Plane's URL in the ",(0,s.jsx)(t.code,{children:"href"})," field. The only\ndifferences are the changed typization. ",(0,s.jsx)(t.code,{children:"proxyPath"})," parameter should be set ",(0,s.jsx)(t.code,{children:'"true"'})," either way."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "@context": {\n    "edc": "https://w3id.org/edc/v0.0.1/ns/",\n    "cx-common": "https://w3id.org/catenax/ontology/common#",\n    "cx-taxo": "https://w3id.org/catenax/taxonomy#",\n    "dct": "http://purl.org/dc/terms/"\n  },\n  "@id": "{{ _.assetId }}",\n  "properties": {\n    "dct:type": {\n      "@id": "cx-taxo:SubmodelBundle"\n    },\n    "cx-common:version": "3.0"\n  },\n  "privateProperties": {\n  },\n  "dataAddress": {\n    "@type": "DataAddress",\n    "type": "HttpData",\n    "baseUrl": "{{ _.url_backend }}",\n    "oauth2:tokenUrl": "{{ _.url_keycl_backend }}",\n    "oauth2:clientId": "{{ _.client_id_backend }}",\n    "oauth2:clientSecretKey": "{{ _.sec_name_vault }}",\n    "proxyQueryParams": "false",\n    "proxyPath": "true",\n    "proxyMethod": "false"\n  }\n}\n'})}),"\n",(0,s.jsx)(t.h3,{id:"usage-policies",children:"Usage Policies"}),"\n",(0,s.jsxs)(t.p,{children:["For Digital Twin Registries, Data Providers are encouraged to only extend Data Offers that make no explicit checks to\nuse-case frameworks (formerly known as ",(0,s.jsx)(t.code,{children:"FrameworkAgreements"}),". The DTR is an Enablement Service that should only be\nvisible once to every Data Consumer in the DSP-Catalog because it is a meta-data broker for data from multiple\nuse-cases. Registering it with a Constraint that's specific to a particular use-case would restrict it only to a small\nsubset of the dataspace. Of course, the DTR could be registered once per use-case but that's not recommended as it\nbloats the catalog and requires a lot of consumer-side processing. That's why Offers for a DTR should always\nbe extended to the dataspace using the at least two Constraints:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Check for an active ",(0,s.jsx)(t.code,{children:"Membership"})," credential. This is agnostic to use-cases but still ensures that a Consumer's VP\nis valid and issued by a common trust-anchor."]}),"\n",(0,s.jsxs)(t.li,{children:["using the DTR as a roadsign in the discovery process is legitimate but requires a set of predefined behavior which\nis why there's a ",(0,s.jsx)(t.code,{children:"purpose"})," for the DTR."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Here's an example"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-json",children:'{\n  "@context": [\n    "https://www.w3.org/ns/odrl.jsonld",\n    {\n      "cx-policy": "https://w3id.org/catenax/policy/"\n    }\n  ],\n  "@type": "Policy",\n  "permission": [\n    {\n      "action": "use",\n      "constraint": {\n        "and": [\n          {\n            "leftOperand": "cx-policy:Membership",\n            "operator": "eq",\n            "rightOperand": "active"\n          },\n          {\n            "leftOperand": "cx-policy:UsagePurpose",\n            "operator": "eq",\n            "rightOperand": "cx.core.digitalTwinRegistry:1"\n          }\n        ]\n      }\n    }\n  ]\n}\n'})}),"\n",(0,s.jsx)(t.p,{children:"For Submodel-APIs, Data Providers must follow the guidelines from their use-case-standards which will usually require\nusing the constraint checking for the associated use-case framework and the corresponding credentials."}),"\n",(0,s.jsx)(t.h2,{id:"data-provisioning",children:"Data Provisioning"}),"\n",(0,s.jsx)(t.h3,{id:"regulatory-compliance-and-security",children:"Regulatory Compliance and Security"}),"\n",(0,s.jsx)(t.p,{children:"The services of this Kit will in many instances hold sensitive data. While sound access management is a prerequisite for\nevery webservice, it is especially important in case of the DTR and Submodels. As they hold competitively sensitive\ndata,unauthorized access is not only a data leak but a potential violation of regulatory compliance such as anti-trust\nlaw."}),"\n",(0,s.jsx)(t.p,{children:"That's why there are a couple shared requirements that DTR-deployments must adhere to:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"If a Data Consumer has no legitimate interest, a AAS-descriptor must not be returned when requested."}),"\n",(0,s.jsxs)(t.li,{children:["If a Data Consumer has a legitimate interest, a AAS-descriptor must not include any data (like ",(0,s.jsx)(t.code,{children:"specificAssetIds"}),")of\ncompanies other than the involved Data Provider and Data Consumer."]}),"\n",(0,s.jsxs)(t.li,{children:["If a Data Provider wants to share data publicly, a AAS-descriptor must only contain the\nattributes ",(0,s.jsx)(t.code,{children:"id"}),", ",(0,s.jsx)(t.code,{children:"submodelDescriptors"}),"\nand those ",(0,s.jsx)(t.code,{children:"specificAssetIds"})," that were issued by the Data Provider and contain no hints of existing business\nrelationships."]}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["As the above properties are exposed not only via the AssetAdministrationShellRegistry interface but also the Discovery\ninterface (via the ",(0,s.jsx)(t.code,{children:"/lookup/shells"})," endpoint), it must not serve more data than specified above."]}),"\n",(0,s.jsx)(t.h3,{id:"versioning",children:"Versioning"}),"\n",(0,s.jsx)(t.p,{children:"Versioning in the Catena-X network is an essential task. This holds true for Digital Twins more specifically, too. The\nnetwork builds on several specifications where changes in API or specifications could break existing communication\nchannels.\nIn a simple scenario (where the Data Provider offers access to a Submodel via DTR and a Data Consumer GETs both\nresources), these are the layers of complexity:"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Versioned Object"}),(0,s.jsx)(t.th,{children:"Presence in the DT-Discovery Process"}),(0,s.jsx)(t.th,{children:"Description"}),(0,s.jsx)(t.th,{children:"Method to increment"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Dataspace Protocol"}),(0,s.jsx)(t.td,{children:"12, 22"}),(0,s.jsxs)(t.td,{children:["The body of the ",(0,s.jsx)(t.code,{children:"{{consumerControlPlane}}/v2/catalog/request"}),"-request includes a reference to a versioned endpoint of a business partner's DSP endpoint like ",(0,s.jsx)(t.code,{children:"{{providerControlPlane}}/api/v1/dsp"})]}),(0,s.jsxs)(t.td,{children:["As the design of the EDC's ",(0,s.jsx)(t.code,{children:"/catalog/request"}),"-API is an implementation detail, Consumers must consistently monitor its versioning. As the EDC-Management-API abstracts the DSP-messages, changes in the DSP may reflect in the Management-API but will not always do so. If a Consumer application decides to interact with the dataspace without mediation of the EDC, this changes."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"AAS Specification"}),(0,s.jsx)(t.td,{children:"4, 5, 15, 25"}),(0,s.jsxs)(t.td,{children:["For all AAS-related EDC-Assets (styled as dcat",":Dataset"," in the catalog), a property cx-common",":version"," must be added referring to the major and minor version of the AAS-spec."]}),(0,s.jsxs)(t.td,{children:["For a major change in the AAS-spec, a new set of Catalog entries must be created by the Data Provider in accordance with the standards. For minor changes (AAS 3.x), Data Providers must signal the version in the ",(0,s.jsx)(t.code,{children:"https://w3id.org/catenax/common#version"})," property of their contract offers and update it with each minor or patch update that's supported. Minor versions must also be signalled in the ",(0,s.jsx)(t.code,{children:"submodelDescriptor"}),".",(0,s.jsx)(t.code,{children:"\xecnterface"}),".",(0,s.jsx)(t.code,{children:"protocol"})," property. If the Submodel API increments with a major version, a new ",(0,s.jsx)(t.code,{children:"interface"})," object must be added to the ",(0,s.jsx)(t.code,{children:"submodelDescriptor"}),"."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:"Data Model Version"}),(0,s.jsx)(t.td,{children:"5, 21, 29"}),(0,s.jsx)(t.td,{children:"The structure of the Submodel is determined by the aspect-model's URN. It includes a section on versioning."}),(0,s.jsx)(t.td,{children:"A new version of the semantic model requires either setup of a new Submodel (with a new Submodel ID and the new semantic ID) or update of an existing submodel-descriptor (with updated semantic ID). This includes updating registration information at the DTR. Rules on backward compatibility need to be considered. It may be requested to offer two Submodel versions at the same time."})]})]})]}),"\n",(0,s.jsx)(t.p,{children:"Here's a list of duties for Data Providers in case they integrate a new Submodel (or version of an existing one) to an\nexisting\ntwin:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Expose a new Submodel to the Dataspace. If its URL is a subpath of one that's already registered as a EDC-Asset,\nthere is no need to specifically register it as a new EDC-Asset and create a Contract Definition for it. However,\nif there is no such EDC-Asset, that's what a Data Provider must do: create an EDC-Asset, connect it to policies via\nthe contract-definition-API and let consumers negotiate for it."}),"\n",(0,s.jsxs)(t.li,{children:["If assetIds are known, the aasId can be discovered via\n",(0,s.jsx)(t.code,{children:"GET https://mydtr.com/api/v3/lookup/shells?assetIds=foo&assetIds=bar"}),". The query-parameters' values are base64url-\nencoded ",(0,s.jsx)(t.code,{children:"specificAssetId"})," objects. If multiple shall be logically AND-chained, a Consumer must use the query-\nparameter-key ",(0,s.jsx)(t.code,{children:"assetIds"})," multiple times."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"POST https://mydtr.com/api/v3/shell-descriptors/{{aasId}}/submodel-descriptors"})," with the (known or obtained)\naasId in the path and the new submodel-descriptor in the body of the request. The attribute ",(0,s.jsx)(t.code,{children:"semanticId"})," is\nmandatory for submodel-descriptors in Catena-X. As defined in CX-0002, semanticIds in Catena-X are aspect-model-urns\n(see CX-0003) including a version."]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"patterns-for-submodel-deployment",children:"Patterns for Submodel Deployment"}),"\n",(0,s.jsx)(t.p,{children:"Data Providers will usually follow one of two patterns:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"Digital Twin Repository: Deploying a dedicated Repository for the persistence of digital twin submodels and related\ndata is the most convenient way to get started with the AAS. It bears the risk of data duplication and introduces\nthe necessity for synchronization mechanisms while on the other hand reducing computational load on the authoring\nsystems that the data originates from."}),"\n",(0,s.jsxs)(t.li,{children:["Delegation: Wrapping an existing API with the AAS-Submodel API yields as a facade that is compliant to CX-0002.\nThe wrapper delegates the incoming requests to the respective backend system. This is feasible in the\nCatena-X dataspace since offering data to the network requires mappings that are naturally dependent on the data's\nsource format. More on data integration can be found in the corresponding ",(0,s.jsx)(t.a,{href:"https://catena-x.net/fileadmin/user_upload/04_Einfuehren_und_umsetzen/Onboarding/DataIntegrationPatterns_Guide_Final_V1.pdf",children:"CX e.V. guide"}),". Equipping each\nBusiness Application with a Submodel-API-Wrapper will lead to a landscape of multiple Submodel-APIs that are\nlinked by the DTR and visible in the Dataspace via a DSP-Connector."]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Both approaches are architecturally valid. Data Consumers do not have to be aware about the deployment pattern employed\nby the Provider - the traversal and discovery algorithm will work either way."}),"\n",(0,s.jsx)(t.h3,{id:"patterns-for-dtr-deployment",children:"Patterns for DTR Deployment"}),"\n",(0,s.jsx)(t.p,{children:"While it is generally possible to equip a Business Application not only with a Submodel- but also a DTR-facade, it is\ngenerally bad practice. There should only be a single DTR in a Provider's catalog. If there were multiple, a Consumer\nwould have no way of knowing which DTR holds the relevant data, forcing him to iterate over all DTRs. This would\nexponentially increase the number of HTTP calls necessary to retrieve the relevant data."}),"\n",(0,s.jsxs)(t.p,{children:["Usually, a DTR will implement a persistence with the specified AAS-APIs for data ingestion specified in the SSP-001\nprofile of the AssetAdministrationShellRegistryService by means of POST endpoints, updatable with PUT and PATCH\nrequests (see ",(0,s.jsx)(t.a,{href:"https://github.com/eclipse-tractusx/sldt-digital-twin-registry",children:"reference implementation"}),"). These APIs should only be accessible by the Data Provider (for instance\nby introduction of proper access control scopes or setting ",(0,s.jsx)(t.code,{children:"proxyMethod = false"}),", see ",(0,s.jsx)(t.a,{href:"#digital-twin-registry-as-edc-data-asset",children:"registration"}),"). Delegation\nas backend integration pattern is more inconvenient as the DTR must process and return reproducible IDs not only for\nthe assets but also for the AAS - this is hard to realize in a pure stateless implementation."]}),"\n",(0,s.jsx)(t.h2,{id:"notice",children:"Notice"}),"\n",(0,s.jsxs)(t.p,{children:["This work is licensed under the ",(0,s.jsx)(t.a,{href:"https://creativecommons.org/licenses/by/4.0/legalcode",children:"CC-BY-4.0"}),"."]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"SPDX-License-Identifier: CC-BY-4.0"}),"\n",(0,s.jsx)(t.li,{children:"SPDX-FileCopyrightText: 2023, 2024 Contributors of the Eclipse Foundation"}),"\n",(0,s.jsxs)(t.li,{children:["Source URL: ",(0,s.jsx)(t.a,{href:"https://github.com/eclipse-tractusx/eclipse-tractusx.github.io",children:"https://github.com/eclipse-tractusx/eclipse-tractusx.github.io"})]}),"\n"]})]})}function h(e={}){let{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},231449:function(e,t,n){n.d(t,{A:()=>i});let i=n.p+"assets/images/digital-twin-kit-logo-0451f63f2d93124ed8a857e84b612507.svg"},884429:function(e,t,n){n.d(t,{R:()=>o,x:()=>r});var i=n(296540);let s={},a=i.createContext(s);function o(e){let t=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(a.Provider,{value:t},e.children)}},30022:function(e){e.exports=JSON.parse('{"id":"kits/digital-twin-kit/software-development-view/software-development-view","title":"Developing with the DT KIT","description":"Digital Twin KIT - Software Development View","source":"@site/docs-kits/kits/digital-twin-kit/software-development-view/software-development-view.md","sourceDirName":"kits/digital-twin-kit/software-development-view","slug":"/kits/digital-twin-kit/software-development-view/","permalink":"/docs-kits/next/kits/digital-twin-kit/software-development-view/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"id":"software-development-view","title":"Developing with the DT KIT","description":"Digital Twin KIT - Software Development View","sidebar_position":1},"sidebar":"kits","previous":{"title":"Adoption View","permalink":"/docs-kits/next/kits/digital-twin-kit/adoption-view"},"next":{"title":"Interaction Patterns","permalink":"/docs-kits/next/kits/digital-twin-kit/software-development-view/interaction-patterns"}}')}}]);