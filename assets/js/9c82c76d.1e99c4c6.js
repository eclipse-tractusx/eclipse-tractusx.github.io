"use strict";(self.webpackChunkeclipse_tractusx_github_io=self.webpackChunkeclipse_tractusx_github_io||[]).push([[54350],{3905:(t,e,n)=>{n.d(e,{Zo:()=>d,kt:()=>m});var a=n(67294);function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(t,e){if(null==t)return{};var n,a,r=function(t,e){if(null==t)return{};var n,a,r={},o=Object.keys(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||(r[n]=t[n]);return r}(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(a=0;a<o.length;a++)n=o[a],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var c=a.createContext({}),l=function(t){var e=a.useContext(c),n=e;return t&&(n="function"==typeof t?t(e):i(i({},e),t)),n},d=function(t){var e=l(t.components);return a.createElement(c.Provider,{value:e},t.children)},p="mdxType",u={inlineCode:"code",wrapper:function(t){var e=t.children;return a.createElement(a.Fragment,{},e)}},h=a.forwardRef((function(t,e){var n=t.components,r=t.mdxType,o=t.originalType,c=t.parentName,d=s(t,["components","mdxType","originalType","parentName"]),p=l(n),h=r,m=p["".concat(c,".").concat(h)]||p[h]||u[h]||o;return n?a.createElement(m,i(i({ref:e},d),{},{components:n})):a.createElement(m,i({ref:e},d))}));function m(t,e){var n=arguments,r=e&&e.mdxType;if("string"==typeof t||r){var o=n.length,i=new Array(o);i[0]=h;var s={};for(var c in e)hasOwnProperty.call(e,c)&&(s[c]=e[c]);s.originalType=t,s[p]="string"==typeof t?t:r,i[1]=s;for(var l=2;l<o;l++)i[l]=n[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},74889:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>l});var a=n(87462),r=(n(67294),n(3905));const o={title:"Restricting users from accessing an asset",sidebar_position:4},i=void 0,s={unversionedId:"tutorials/e2e/boost/restrictData",id:"tutorials/e2e/boost/restrictData",title:"Restricting users from accessing an asset",description:"Create an asset",source:"@site/docs/tutorials/e2e/boost/restrictData.md",sourceDirName:"tutorials/e2e/boost",slug:"/tutorials/e2e/boost/restrictData",permalink:"/docs/tutorials/e2e/boost/restrictData",draft:!1,editUrl:"https://github.com/eclipse-tractusx/eclipse-tractusx.github.io/tree/main/docs/tutorials/e2e/boost/restrictData.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{title:"Restricting users from accessing an asset",sidebar_position:4},sidebar:"tutorials",previous:{title:"Consume data",permalink:"/docs/tutorials/e2e/boost/consumeData"},next:{title:"DTR Tutorial",permalink:"/docs/tutorials/e2e/boost/dtrTutorial"}},c={},l=[{value:"Create an asset",id:"create-an-asset",level:2},{value:"Create a permissive access policy",id:"create-a-permissive-access-policy",level:2},{value:"Create a permissive contract policy",id:"create-a-permissive-contract-policy",level:2},{value:"Create a contract definition",id:"create-a-contract-definition",level:2},{value:"Request catalog",id:"request-catalog",level:2},{value:"Notice",id:"notice",level:2}],d={toc:l};function p(t){let{components:e,...n}=t;return(0,r.kt)("wrapper",(0,a.Z)({},d,n,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"create-an-asset"},"Create an asset"),(0,r.kt)("p",null,"Bob will once again be the data provider. But this time Bob does not want Alice to see the asset.\nThe first step for Bob will again be to create an asset."),(0,r.kt)("p",null,"Action (Bob): Create an asset using the following ",(0,r.kt)("inlineCode",{parentName:"p"},"curl")," command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location \'http://dataprovider-controlplane.tx.test/management/v3/assets\' \\\n--header \'Content-Type: application/json\' \\\n--header \'X-Api-Key: TEST2\' \\\n--data-raw \'{\n    "@context": {},\n    "@type": "Asset",\n    "@id": "4",\n    "properties": {\n        "description": "Product EDC Demo Asset 4"\n    },\n    "dataAddress": {\n        "@type": "DataAddress",\n        "type": "HttpData",\n        "baseUrl": "https://jsonplaceholder.typicode.com/todos/4"\n    }\n}\' | jq\n')),(0,r.kt)("h2",{id:"create-a-permissive-access-policy"},"Create a permissive access policy"),(0,r.kt)("p",null,"Now that the asset has been created, Bob creates an access policy that defines who can see and therefore access the asset in his catalog. To specify this access, Bob uses the Business Partner Number (BPN). The BPN is a unique identifier for participants of a data space. Bob knows that his exchange partner for this asset has the BPN ",(0,r.kt)("inlineCode",{parentName:"p"},"BPNL00000003AVTH")," and Alice BPN is ",(0,r.kt)("inlineCode",{parentName:"p"},"BPNL00000003AZQP")),(0,r.kt)("p",null,"Action (Bob): Create the access policy using the following ",(0,r.kt)("inlineCode",{parentName:"p"},"curl")," command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location \'http://dataprovider-controlplane.tx.test/management/v2/policydefinitions\' \\\n--header \'Content-Type: application/json\' \\\n--header \'X-Api-Key: TEST2\' \\\n--data-raw \'{\n  "@context": {\n    "odrl": "http://www.w3.org/ns/odrl/2/"\n  },\n  "@type": "PolicyDefinitionRequestDto",\n  "@id": "41",\n  "policy": {\n    "@type": "Policy",\n    "odrl:permission": [\n      {\n        "odrl:action": "USE",\n        "odrl:constraint": {\n          "@type": "LogicalConstraint",\n          "odrl:or": [\n            {\n              "@type": "Constraint",\n              "odrl:leftOperand": "BusinessPartnerNumber",\n              "odrl:operator": {\n                "@id": "odrl:eq"\n              },\n              "odrl:rightOperand": "BPNL00000003AVTH"\n            }\n          ]\n        }\n      }\n    ]\n  }\n}\' | jq\n')),(0,r.kt)("p",null,"The policydefinition is created with the ID ",(0,r.kt)("inlineCode",{parentName:"p"},"41")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "@type": "edc:IdResponse",\n  "@id": "41",\n  "edc:createdAt": 1715674423858,\n  "@context": {\n    "dct": "http://purl.org/dc/terms/",\n    "tx": "https://w3id.org/tractusx/v0.0.1/ns/",\n    "edc": "https://w3id.org/edc/v0.0.1/ns/",\n    "dcat": "https://www.w3.org/ns/dcat/",\n    "odrl": "http://www.w3.org/ns/odrl/2/",\n    "dspace": "https://w3id.org/dspace/v0.8/"\n  }\n}\n')),(0,r.kt)("p",null,"Bob defined a policy which restricts access to connector(s) with the BusinessPartnerNumber ",(0,r.kt)("inlineCode",{parentName:"p"},"BPNL00000003AVTH"),". As Alice does not own this BPN, she should not be able to access the asset."),(0,r.kt)("h2",{id:"create-a-permissive-contract-policy"},"Create a permissive contract policy"),(0,r.kt)("p",null,"Since an access policy has already been created, a contract policy must be created and linked in the contract definition."),(0,r.kt)("p",null,"Action (Bob): Create the contract policy using the following ",(0,r.kt)("inlineCode",{parentName:"p"},"curl")," command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location \'http://dataprovider-controlplane.tx.test/management/v2/policydefinitions\' \\\n--header \'Content-Type: application/json\' \\\n--header \'X-Api-Key: TEST2\' \\\n--data-raw \'{\n  "@context": {\n    "odrl": "http://www.w3.org/ns/odrl/2/"\n  },\n  "@type": "PolicyDefinitionRequestDto",\n  "@id": "42",\n  "policy": {\n    "@type": "Policy",\n    "odrl:permission": [\n      {\n        "odrl:action": "USE",\n        "odrl:constraint": {\n          "@type": "LogicalConstraint",\n          "odrl:or": [\n            {\n              "@type": "Constraint",\n              "odrl:leftOperand": "BpnCredential",\n              "odrl:operator": {\n                "@id": "odrl:eq"\n              },\n              "odrl:rightOperand": "active"\n            }\n          ]\n        }\n      }\n    ]\n  }\n}\' | jq\n')),(0,r.kt)("p",null,"The response should be something like this"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "@type": "edc:IdResponse",\n  "@id": "42",\n  "edc:createdAt": 1715674546763,\n  "@context": {\n    "dct": "http://purl.org/dc/terms/",\n    "tx": "https://w3id.org/tractusx/v0.0.1/ns/",\n    "edc": "https://w3id.org/edc/v0.0.1/ns/",\n    "dcat": "https://www.w3.org/ns/dcat/",\n    "odrl": "http://www.w3.org/ns/odrl/2/",\n    "dspace": "https://w3id.org/dspace/v0.8/"\n  }\n}\n')),(0,r.kt)("h2",{id:"create-a-contract-definition"},"Create a contract definition"),(0,r.kt)("p",null,"Lastly, the asset and the access policy must be linked in a contract definition.\nAction (Bob): Create a contract definition including the asset and the policies you have created. For this, use the following ",(0,r.kt)("inlineCode",{parentName:"p"},"curl")," command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location \'http://dataprovider-controlplane.tx.test/management/v2/contractdefinitions\' \\\n--header \'Content-Type: application/json\' \\\n--header \'X-Api-Key: TEST2\' \\\n--data-raw \'{\n    "@context": {},\n    "@id": "4",\n    "@type": "ContractDefinition",\n    "accessPolicyId": "41",\n    "contractPolicyId": "42",\n    "assetsSelector" : {\n        "@type" : "CriterionDto",\n        "operandLeft": "https://w3id.org/edc/v0.0.1/ns/id",\n        "operator": "=",\n        "operandRight": "4"\n    }\n}\' | jq\n')),(0,r.kt)("p",null,"A response should look like this"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "@type": "edc:IdResponse",\n  "@id": "4",\n  "edc:createdAt": 1715674670136,\n  "@context": {\n    "dct": "http://purl.org/dc/terms/",\n    "tx": "https://w3id.org/tractusx/v0.0.1/ns/",\n    "edc": "https://w3id.org/edc/v0.0.1/ns/",\n    "dcat": "https://www.w3.org/ns/dcat/",\n    "odrl": "http://www.w3.org/ns/odrl/2/",\n    "dspace": "https://w3id.org/dspace/v0.8/"\n  }\n}\n')),(0,r.kt)("h2",{id:"request-catalog"},"Request catalog"),(0,r.kt)("p",null,"Let\xb4s see if Alice can see the Asset."),(0,r.kt)("p",null,"Action (Alice): Execute a request using the following ",(0,r.kt)("inlineCode",{parentName:"p"},"curl")," command:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location \'http://dataconsumer-1-controlplane.tx.test/management/v2/catalog/request\' \\\n--header \'Content-Type: application/json\' \\\n--header \'X-Api-Key: TEST1\' \\\n--data-raw \'{\n    "@context": {},\n    "protocol": "dataspace-protocol-http",\n    "counterPartyAddress": "http://dataprovider-controlplane.tx.test/api/v1/dsp",\n    "querySpec": {\n        "offset": 0,\n        "limit": 100\n    }\n}\' | jq\n')),(0,r.kt)("p",null,"The response doesnt include the cataolog entry for the asset/offer with id4"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "@id": "3b276870-5cc5-4546-b793-e2c8d39e1010",\n  "@type": "dcat:Catalog",\n  "dcat:dataset": [\n    {\n      "@id": "registry-asset",\n      "@type": "dcat:Dataset",\n      "odrl:hasPolicy": {\n        "@id": "ZGM3MjMyYTAtMDRjOC00MTVjLWI2NmQtOGJmNTQ1MWMyYmIy:cmVnaXN0cnktYXNzZXQ=:MjdiYWExMGItMTAzMC00MmY5LWI0YjMtMzJmY2UyODI5NThl",\n        "@type": "odrl:Set",\n        "odrl:permission": {\n          "odrl:target": "registry-asset",\n          "odrl:action": {\n            "odrl:type": "USE"\n          },\n          "odrl:constraint": {\n            "odrl:or": {\n              "odrl:leftOperand": "PURPOSE",\n              "odrl:operator": {\n                "@id": "odrl:eq"\n              },\n              "odrl:rightOperand": "ID 3.0 Trace"\n            }\n          }\n        },\n        "odrl:prohibition": [],\n        "odrl:obligation": [],\n        "odrl:target": "registry-asset"\n      },\n      "dcat:distribution": [\n        {\n          "@type": "dcat:Distribution",\n          "dct:format": {\n            "@id": "HttpProxy"\n          },\n          "dcat:accessService": "7b76c9c5-d7f9-42c1-8784-a2820a60bb0f"\n        },\n        {\n          "@type": "dcat:Distribution",\n          "dct:format": {\n            "@id": "AmazonS3"\n          },\n          "dcat:accessService": "7b76c9c5-d7f9-42c1-8784-a2820a60bb0f"\n        }\n      ],\n      "edc:type": "data.core.digitalTwinRegistry",\n      "edc:description": "Digital Twin Registry Endpoint of IRS DEV",\n      "edc:id": "registry-asset"\n    },\n    {\n      "@id": "urn:uuid:69653fc9-11b5-4321-98ca-e60d2dc35379",\n      "@type": "dcat:Dataset",\n      "odrl:hasPolicy": {\n        "@id": "MDkyNmVhMGUtZWVmMC00OTlmLTliZjktNmE1MGU3MGUzOGQy:dXJuOnV1aWQ6Njk2NTNmYzktMTFiNS00MzIxLTk4Y2EtZTYwZDJkYzM1Mzc5:YWUwOTFiOTYtNGM0Ni00YzE0LWEyZGYtY2Y5NDNlMzY1NDY4",\n        "@type": "odrl:Set",\n        "odrl:permission": {\n          "odrl:target": "urn:uuid:69653fc9-11b5-4321-98ca-e60d2dc35379",\n          "odrl:action": {\n            "odrl:type": "USE"\n          },\n          "odrl:constraint": {\n            "odrl:or": {\n              "odrl:leftOperand": "PURPOSE",\n              "odrl:operator": {\n                "@id": "odrl:eq"\n              },\n              "odrl:rightOperand": "ID 3.0 Trace"\n            }\n          }\n        },\n        "odrl:prohibition": [],\n        "odrl:obligation": [],\n        "odrl:target": "urn:uuid:69653fc9-11b5-4321-98ca-e60d2dc35379"\n      },\n      "dcat:distribution": [\n        {\n          "@type": "dcat:Distribution",\n          "dct:format": {\n            "@id": "HttpProxy"\n          },\n          "dcat:accessService": "7b76c9c5-d7f9-42c1-8784-a2820a60bb0f"\n        },\n        {\n          "@type": "dcat:Distribution",\n          "dct:format": {\n            "@id": "AmazonS3"\n          },\n          "dcat:accessService": "7b76c9c5-d7f9-42c1-8784-a2820a60bb0f"\n        }\n      ],\n      "edc:description": "IRS EDC Test Asset",\n      "edc:id": "urn:uuid:69653fc9-11b5-4321-98ca-e60d2dc35379"\n    },\n    {\n      "@id": "3",\n      "@type": "dcat:Dataset",\n      "odrl:hasPolicy": {\n        "@id": "Mw==:Mw==:YjE0ODU2M2MtMWM5MC00NDg4LThmZmItZmJjZjc0NjQzZTE5",\n        "@type": "odrl:Set",\n        "odrl:permission": [],\n        "odrl:prohibition": [],\n        "odrl:obligation": [],\n        "odrl:target": "3"\n      },\n      "dcat:distribution": [\n        {\n          "@type": "dcat:Distribution",\n          "dct:format": {\n            "@id": "HttpProxy"\n          },\n          "dcat:accessService": "7b76c9c5-d7f9-42c1-8784-a2820a60bb0f"\n        },\n        {\n          "@type": "dcat:Distribution",\n          "dct:format": {\n            "@id": "AmazonS3"\n          },\n          "dcat:accessService": "7b76c9c5-d7f9-42c1-8784-a2820a60bb0f"\n        }\n      ],\n      "edc:description": "Product EDC Demo Asset 3",\n      "edc:id": "3"\n    }\n  ],\n  "dcat:service": {\n    "@id": "7b76c9c5-d7f9-42c1-8784-a2820a60bb0f",\n    "@type": "dcat:DataService",\n    "dct:terms": "connector",\n    "dct:endpointUrl": "http://dataprovider-controlplane.tx.test/api/v1/dsp"\n  },\n  "edc:participantId": "BPNL00000003AYRE",\n  "@context": {\n    "dct": "http://purl.org/dc/terms/",\n    "tx": "https://w3id.org/tractusx/v0.0.1/ns/",\n    "edc": "https://w3id.org/edc/v0.0.1/ns/",\n    "dcat": "https://www.w3.org/ns/dcat/",\n    "odrl": "http://www.w3.org/ns/odrl/2/",\n    "dspace": "https://w3id.org/dspace/v0.8/"\n  }\n}\n')),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"Bob\u2019s asset (ID: 4) should not be displayed. The access policy successfully restricts Alice from seeing and therefore obtaining Bob\u2019s asset. Now Bob is able to manage who sees which of his sensitive data assets. If Bob decides to enable Alice to see his asset, he can simply adjust the access policy definition and add Alice BPN ",(0,r.kt)("inlineCode",{parentName:"p"},"BPNL00000003AZQP")," to the list of BPNs.")),(0,r.kt)("h2",{id:"notice"},"Notice"),(0,r.kt)("p",null,"This work is licensed under the ",(0,r.kt)("a",{parentName:"p",href:"https://creativecommons.org/licenses/by/4.0/legalcode"},"CC-BY-4.0"),"."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"SPDX-License-Identifier: CC-BY-4.0"),(0,r.kt)("li",{parentName:"ul"},"SPDX-FileCopyrightText: 2023 sovity GmbH"),(0,r.kt)("li",{parentName:"ul"},"SPDX-FileCopyrightText: 2023 SAP SE"),(0,r.kt)("li",{parentName:"ul"},"SPDX-FileCopyrightText: 2023 msg systems AG"),(0,r.kt)("li",{parentName:"ul"},"Source URL: ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/eclipse-tractusx/eclipse-tractusx.github.io"},"https://github.com/eclipse-tractusx/eclipse-tractusx.github.io"))))}p.isMDXComponent=!0}}]);