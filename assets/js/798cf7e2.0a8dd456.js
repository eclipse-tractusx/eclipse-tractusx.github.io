"use strict";(self.webpackChunkeclipse_tractusx_github_io=self.webpackChunkeclipse_tractusx_github_io||[]).push([[96173],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>g});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},d=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},m="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),m=p(a),c=r,g=m["".concat(s,".").concat(c)]||m[c]||u[c]||i;return a?n.createElement(g,o(o({ref:t},d),{},{components:a})):n.createElement(g,o({ref:t},d))}));function g(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=a[p];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},95426:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>m,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var n=a(87462),r=(a(67294),a(3905));const i={title:"TRG 4.02 - Base Images"},o=void 0,l={unversionedId:"release/trg-4/trg-4-02",id:"release/trg-4/trg-4-02",title:"TRG 4.02 - Base Images",description:"| Status | Created     | Post-History                                                                    |",source:"@site/docs/release/trg-4/trg-4-02.md",sourceDirName:"release/trg-4",slug:"/release/trg-4/trg-4-02",permalink:"/docs/release/trg-4/trg-4-02",draft:!1,editUrl:"https://github.com/eclipse-tractusx/eclipse-tractusx.github.io/tree/main/docs/release/trg-4/trg-4-02.md",tags:[],version:"current",frontMatter:{title:"TRG 4.02 - Base Images"},sidebar:"docs",previous:{title:"TRG 4.01 - Image tagging",permalink:"/docs/release/trg-4/trg-4-01"},next:{title:"TRG 4.03 - Non-root container",permalink:"/docs/release/trg-4/trg-4-03"}},s={},p=[{value:"Why",id:"why",level:2},{value:"Description",id:"description",level:2},{value:"Aligned Base Images",id:"aligned-base-images",level:3},{value:"Use minor or major Image Tag",id:"use-minor-or-major-image-tag",level:3},{value:"Use Base Image as-is",id:"use-base-image-as-is",level:3}],d={toc:p};function m(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Status"),(0,r.kt)("th",{parentName:"tr",align:null},"Created"),(0,r.kt)("th",{parentName:"tr",align:null},"Post-History"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Update"),(0,r.kt)("td",{parentName:"tr",align:null},"15-Jan-2024"),(0,r.kt)("td",{parentName:"tr",align:null},"Add image tag usage, use base image as-is")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Active"),(0,r.kt)("td",{parentName:"tr",align:null},"06-Dec-2023"),(0,r.kt)("td",{parentName:"tr",align:null},"Add advantages of Dockerhub images")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Active"),(0,r.kt)("td",{parentName:"tr",align:null},"04-May-2023"),(0,r.kt)("td",{parentName:"tr",align:null},"Remove notice in favor of dedicated TRG; Add mandatory base image for frontends")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Active"),(0,r.kt)("td",{parentName:"tr",align:null},"25-Nov-2022"),(0,r.kt)("td",{parentName:"tr",align:null},"Initial release")))),(0,r.kt)("h2",{id:"why"},"Why"),(0,r.kt)("p",null,"As part of our legal due diligence, we need to provide the best information possible about our distributed (published)\nDocker images. Similar to our 3rd-party dependency scans and the ",(0,r.kt)("inlineCode",{parentName:"p"},"DEPENDENCIES")," file, Docker images also have to be\nscanned and the results published. We want to help you to keep a high standard process, by defining guidelines,\ndescribed in this TRG."),(0,r.kt)("h2",{id:"description"},"Description"),(0,r.kt)("p",null,"As Eclipse Tractus-X project, we don't have automated processes for publishing container scan results (yet). This is why\nwe use information that is already gathered for us. DockerHub is running container scans for\nall ",(0,r.kt)("a",{parentName:"p",href:"https://docs.docker.com/trusted-content/official-images/"},"official images")," and is publishing the scans result in\nthe ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/docker-library/repo-info"},"docker-library/repo-info repository"),"."),(0,r.kt)("p",null,"Utilizing official images from DockerHub is advantageous due to its role as a trusted repository of curated and verified\nopen source containers. DockerHub provides a centralized platform where developers can access a wide range of pre-built\ncontainers which adhere to established best practices and meet certain standards of quality, security, and reliability,\ngiving developers confidence in the integrity of the containers they deploy. By incorporating prepared images, teams can\nfoster consistency across environments, reduce the likelihood of vulnerabilities, and accelerate the overall software\ndelivery pipeline rather than managing complex container configurations from scratch."),(0,r.kt)("p",null,"We are leveraging this information by restricting the base images we use for our published container images to a minimal\nset. Aligning on specific base images also gives us the opportunity to provide you with templates for the legal notice,\nlike described in ",(0,r.kt)("a",{parentName:"p",href:"/docs/release/trg-4/trg-4-06"},"TRG 4.06 - Notice for docker images")),(0,r.kt)("h3",{id:"aligned-base-images"},"Aligned Base Images"),(0,r.kt)("p",null,"The following table lists container base images, that are already agreed on."),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Language / Runtime / OS"),(0,r.kt)("th",{parentName:"tr",align:null},"Container base image"),(0,r.kt)("th",{parentName:"tr",align:null},"Notes"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Java / Kotlin / JVM based"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://hub.docker.com/_/eclipse-temurin"},"Eclipse Temurin")),(0,r.kt)("td",{parentName:"tr",align:null},"prefer JRE over JDK and alpine tags for your JRE version, e.g.:",(0,r.kt)("br",null),(0,r.kt)("inlineCode",{parentName:"td"},"21-jre"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"21-jre-alpine"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"20-jre"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"20-jre-alpine"),", etc.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"JS frontends"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://hub.docker.com/r/nginxinc/nginx-unprivileged"},"nginx-unprivileged")),(0,r.kt)("td",{parentName:"tr",align:null},"prefer ",(0,r.kt)("inlineCode",{parentName:"td"},"1.25"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"1.25-alpine")," or ",(0,r.kt)("inlineCode",{parentName:"td"},"alpine")," tag")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},".NET runtime"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://hub.docker.com/_/microsoft-dotnet-runtime"},".NET runtime")),(0,r.kt)("td",{parentName:"tr",align:null},"prefer ",(0,r.kt)("inlineCode",{parentName:"td"},"8.0-alpine")," tag")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"ASP.NET runtime"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://hub.docker.com/_/microsoft-dotnet-aspnet"},"ASP.NET core runtime")),(0,r.kt)("td",{parentName:"tr",align:null},"prefer ",(0,r.kt)("inlineCode",{parentName:"td"},"8.0-alpine")," tag")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"Linux"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://hub.docker.com/_/alpine"},"Alpine Linux")),(0,r.kt)("td",{parentName:"tr",align:null},"prefer ",(0,r.kt)("inlineCode",{parentName:"td"},"3.16"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"3.17"),", ",(0,r.kt)("inlineCode",{parentName:"td"},"3.18")," or ",(0,r.kt)("inlineCode",{parentName:"td"},"3.19")," tag")))),(0,r.kt)("p",null,"If the language or runtime environment of your product is not listed above, feel free\nto ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/eclipse-tractusx/sig-infra/discussions"},"start a discussion")," and propose your preferred container\nimages as base image."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"As stated in the description above, base image usage is particularly aligned for container images, that we distribute by\npublishing them on DockerHub. In case you are using Docker images for build or testing purposes (for example ",(0,r.kt)("em",{parentName:"p"},"pandoc")," or\n",(0,r.kt)("em",{parentName:"p"},"cypress"),", etc.) and you do not publish the images, you can use other publicly available image, as long as the tools are\nopen source license compliant."),(0,r.kt)("p",{parentName:"admonition"},"For automated TRG checks, you can skip base image checks on Dockerfiles by declaring it in the ",(0,r.kt)("inlineCode",{parentName:"p"},".tractusx")," metadata\nfiles. Details can be found in\nthe ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/eclipse-tractusx/tractusx-quality-checks/blob/main/docs/metadata_file.md"},"metadata file documentation"))),(0,r.kt)("h3",{id:"use-minor-or-major-image-tag"},"Use minor or major Image Tag"),(0,r.kt)("p",null,"Do not use an image tag pointing to a patch version of the image. Instead, use an image tag containing either minor or\nmajor version."),(0,r.kt)("p",null,"To keep application images compliant, up-to-date and secure it is mandatory to use image tags which allows to rebuild\nthe applications container image without touching the ",(0,r.kt)("inlineCode",{parentName:"p"},"Dockerfile")," to pull an updated version of the base image (e.g. to\nfix a potential problem inside the base image."),(0,r.kt)("admonition",{title:"Do not use image tag with patch version",type:"warning"},(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-Dockerfile"},"FROM alpine:3.18.5 as BUILDER\n\nCOPY . /app/build\nWORKDIR /app/build\nRUN build\n\nFROM alpine:3.18.5\n\nCOPY --from=BUILDER /app/build /app\n[...]\n"))),(0,r.kt)("admonition",{title:"Use image tag with minor or major version",type:"tip"},(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-Dockerfile"},"FROM alpine:3 as BUILDER\n\nCOPY . /app/build\nWORKDIR /app/build\nRUN build\n\nFROM alpine:3.18\n\nCOPY --from=BUILDER /app/build /app\n\n[...]\n"))),(0,r.kt)("p",null,"The next time the applications container image is created, an updated base image will be used, if available."),(0,r.kt)("h3",{id:"use-base-image-as-is"},"Use Base Image as-is"),(0,r.kt)("p",null,"It is recommended to use the base image ",(0,r.kt)("strong",{parentName:"p"},"as-is")," and to not modify or update it."),(0,r.kt)("p",null,"Do not use package manager update mechanisms to update the runtime of the base image (e.g. to fix security\nvulnerabilities). Updating or modifying the base image might pull in a new version of a library which is no longer under\nthe correct Intellectual Property and/or license."),(0,r.kt)("p",null,"Same applies for installing additional tools, libraries, commands, which modifies the base image. If possible, select a\nbase image for your application that contains all dependent tools."),(0,r.kt)("admonition",{title:"Do not update or install additional packages",type:"warning"},(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-Dockerfile"},'# Call for feedback: Does this example make sense at all or \n# should it be removed?\nFROM alpine:3.18.2\n\nCOPY some/binary /app/\nRUN apk update && apk upgrade \\ # fix CVE-2023-123\n    apk add someTool            # install pkg "someTool"\n'))),(0,r.kt)("p",null,"In the example a patch level image tag of alpine is used, which is not recommended, and an update/upgrade is done to get\nthe latest versions of all installed packages installed. Instead, use a minor image tag (e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"alpine:3.18"),") as\nrecommended in ",(0,r.kt)("a",{parentName:"p",href:"#use-minor-or-major-image-tag"},(0,r.kt)("em",{parentName:"a"},"Use minor or major Image Tag")),"."),(0,r.kt)("p",null,"An exception from modifying the base image might be a build stage in the ",(0,r.kt)("inlineCode",{parentName:"p"},"Dockerfile"),", as long as the resulting image\nuses an unmodified base image, e.g.:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-Dockerfile"},'FROM alpine:3.18 as BUILDER\n\nENV DOWLOAD_URL "https://some-fqdn/tool.jar"\n\nRUN apk update && apk add curl=8.5.0-r0 --no-cache\nRUN curl -L --proto "=https" -sSf ${DOWLOAD_URL} \\\n    --output /tmp/tool.jar\n\nFROM eclipse-temurin:19-jre-alpine\n\nCOPY --from=otel /tmp/tool.jar .\n\n[...]\n')))}m.isMDXComponent=!0}}]);