"use strict";(self.webpackChunkeclipse_tractusx_github_io=self.webpackChunkeclipse_tractusx_github_io||[]).push([[11202],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),c=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=c(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),d=c(n),h=o,m=d["".concat(l,".").concat(h)]||d[h]||u[h]||r;return n?a.createElement(m,s(s({ref:t},p),{},{components:n})):a.createElement(m,s({ref:t},p))}));function m(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,s=new Array(r);s[0]=h;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i[d]="string"==typeof e?e:o,s[1]=i;for(var c=2;c<r;c++)s[c]=n[c];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},19227:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>c});var a=n(87462),o=(n(67294),n(3905));const r={title:"Consume data",sidebar_position:3},s=void 0,i={unversionedId:"tutorials/e2e/boost/consumeData",id:"tutorials/e2e/boost/consumeData",title:"Consume data",description:"This step continues the journey of our data consumer Alice. After the data provider Bob has successfully provided his data as a contract definition in his catalog. Alice will now consume the data.",source:"@site/docs/tutorials/e2e/boost/consumeData.md",sourceDirName:"tutorials/e2e/boost",slug:"/tutorials/e2e/boost/consumeData",permalink:"/docs/tutorials/e2e/boost/consumeData",draft:!1,editUrl:"https://github.com/eclipse-tractusx/eclipse-tractusx.github.io/tree/main/docs/tutorials/e2e/boost/consumeData.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Consume data",sidebar_position:3},sidebar:"tutorials",previous:{title:"Provide data",permalink:"/docs/tutorials/e2e/boost/provideData"},next:{title:"Restricting users from accessing an asset",permalink:"/docs/tutorials/e2e/boost/restrictData"}},l={},c=[{value:"Request the catalog",id:"request-the-catalog",level:2},{value:"Negotiate a contract",id:"negotiate-a-contract",level:2},{value:"Starting the data transfer",id:"starting-the-data-transfer",level:2},{value:"Consume the data",id:"consume-the-data",level:2},{value:"Notice",id:"notice",level:2}],p={toc:c};function d(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,a.Z)({},p,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This step continues the journey of our data consumer Alice. After the data provider Bob has successfully provided his data as a contract definition in his catalog. Alice will now consume the data."),(0,o.kt)("p",null,"We will use plain CLI tools (",(0,o.kt)("inlineCode",{parentName:"p"},"curl"),") for this, but feel free to use graphical tools such as Postman or Insomnia."),(0,o.kt)("h2",{id:"request-the-catalog"},"Request the catalog"),(0,o.kt)("p",null,"To see Bob's data offerings, Alice must request access to his catalog. The catalog shows all the assets that Alice can consume from Bob."),(0,o.kt)("p",null,"So Alice requests Bob's catalog using the following ",(0,o.kt)("inlineCode",{parentName:"p"},"curl")," commands:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location \'http://localhost/alice/management/v2/catalog/request\' \\\n--header \'Content-Type: application/json\' \\\n--header \'X-Api-Key: password\' \\\n--data-raw \'{\n    "@context": {},\n    "protocol": "dataspace-protocol-http",\n    "counterPartyAddress": "http://bob-controlplane:8084/api/v1/dsp",\n    "querySpec": {\n        "offset": 0,\n        "limit": 100\n    }\n}\' | jq\n')),(0,o.kt)("p",null,"The response shows all available data offerings in Bob's catalog. Bob has already told Alice that he gave the Asset the ID 3, and added a simple description to make it easier for Alice to identify."),(0,o.kt)("p",null,'Alice finds the Asset with the ID 3 and the description "Product EDC Demo Asset 3" in the catalog. Now that she is sure which Asset she wants to consume, she wants to start the data transfer.'),(0,o.kt)("h2",{id:"negotiate-a-contract"},"Negotiate a contract"),(0,o.kt)("p",null,"But before she can transfer the data, she must negotiate the contract with Bob. To do this, she uses the following ",(0,o.kt)("inlineCode",{parentName:"p"},"curl")," command:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location \'http://localhost/alice/management/v2/contractnegotiations\' \\\n--header \'Content-Type: application/json\' \\\n--header \'X-Api-Key: password\' \\\n--data-raw \'{\n "@context": {\n    "odrl": "http://www.w3.org/ns/odrl/2/"\n },\n "@type": "NegotiationInitiateRequestDto",\n "connectorAddress": "http://bob-controlplane:8084/api/v1/dsp",\n "protocol": "dataspace-protocol-http",\n "providerId": "BPNL000000000002",\n "offer": {\n    "offerId": "Mw==:Mw==:ODRkYjJhZjQtZjMxOC00ZjgyLThjMjktODQwZThjYjBjNjVl",\n    "assetId": "3",\n    "policy": {\n        "@type": "odrl:Set",\n        "odrl:permission": [],\n        "odrl:prohibition": [],\n        "odrl:obligation": [],\n        "odrl:target": "3"\n    }\n }\n}\' | jq\n')),(0,o.kt)("p",null,"In the response, Alice gets a UUID. This is the ID of the created contract negotiation. Alice can now use this ID to see the current status of the negotiation and - if the negotiation was successful - the ID of the created contract agreement."),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Make sure to replace ",(0,o.kt)("inlineCode",{parentName:"p"},"<ID>")," in the URL with the UUID you just received.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location 'http://localhost/alice/management/v2/contractnegotiations/<ID>' \\\n--header 'X-Api-Key: password' | jq\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If the negotiation was ",(0,o.kt)("strong",{parentName:"li"},"successful"),", Alice will see an ouput as shown below."),(0,o.kt)("li",{parentName:"ul"},"If the negotiation was ",(0,o.kt)("strong",{parentName:"li"},"unsuccessful"),", the negotiation state (",(0,o.kt)("inlineCode",{parentName:"li"},"edc:state"),") will be ",(0,o.kt)("inlineCode",{parentName:"li"},"TERMINATED")," and no contract agreement ID will be present.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "@type": "edc:ContractNegotiation",\n  "@id": "4e74a632-94bc-4bfb-acf5-230f7d18b080",\n  "edc:type": "CONSUMER",\n  "edc:protocol": "dataspace-protocol-http",\n  "edc:state": "FINALIZED",\n  "edc:counterPartyId": "BPNL000000000002",\n  "edc:counterPartyAddress": "http://bob-controlplane:8084/api/v1/dsp",\n  "edc:callbackAddresses": [],\n  "edc:createdAt": 1702989093837,\n  "edc:contractAgreementId": "Mw==:Mw==:NmY5MDA4OGEtOWY1ZC00YmYyLWFiZjMtMjRiNzY0YzEyOTk4",\n  "@context": {\n    "dct": "https://purl.org/dc/terms/",\n    "tx": "https://w3id.org/tractusx/v0.0.1/ns/",\n    "edc": "https://w3id.org/edc/v0.0.1/ns/",\n    "dcat": "https://www.w3.org/ns/dcat/",\n    "odrl": "http://www.w3.org/ns/odrl/2/",\n    "dspace": "https://w3id.org/dspace/v0.8/"\n  }\n}\n')),(0,o.kt)("p",null,"Alice now has a contract with Bob and can begin transferring the asset's data."),(0,o.kt)("h2",{id:"starting-the-data-transfer"},"Starting the data transfer"),(0,o.kt)("p",null,'Alice wants to send the data to her backend application ("',(0,o.kt)("a",{parentName:"p",href:"http://backend:8080"},"http://backend:8080"),'"). So she uses the following command to direct the data from Asset 3 to her desired data sink.'),(0,o.kt)("admonition",{type:"warning"},(0,o.kt)("p",{parentName:"admonition"},"For testing purposes, you should replace ",(0,o.kt)("inlineCode",{parentName:"p"},"backend:8080")," with your own test API or use ",(0,o.kt)("a",{parentName:"p",href:"https://webhook.site/"},"webhook.site"),' as your backend system.\nIf you do not change this, you will not be able to view the received token, which is required for requesting the data!\nIf you are using webhook.site, please make sure that you use "Your unique URL" and that you do not transfer any sensitive information to webhook.'),(0,o.kt)("p",{parentName:"admonition"},"Replace ",(0,o.kt)("inlineCode",{parentName:"p"},"<contractAgreementId>")," with the contract agreement ID you received in the previous step.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location \'http://localhost/alice/management/v2/transferprocesses\' \\\n--header \'Content-Type: application/json\' \\\n--header \'X-Api-Key: password\' \\\n--data-raw \'{\n    "@context": {\n        "odrl": "http://www.w3.org/ns/odrl/2/"\n    },\n    "assetId": "3",\n    "connectorAddress": "http://bob-controlplane:8084/api/v1/dsp",\n    "connectorId": "BPNL000000000002",\n    "contractId": "<contractAgreementId>",\n    "dataDestination": {\n        "type": "HttpProxy"\n    },\n    "privateProperties": {\n        "receiverHttpEndpoint": "http://backend:8080"\n    },\n    "protocol": "dataspace-protocol-http",\n    "transferType": {\n        "contentType": "application/octet-stream",\n        "isFinite": true\n    }\n}\' | jq\n')),(0,o.kt)("p",null,"Just to make sure everything worked, Alice uses another ",(0,o.kt)("inlineCode",{parentName:"p"},"curl")," command to check if the transfer was successful."),(0,o.kt)("p",null,"In the response, Alice gets a UUID. This is the ID of the created transfer. Alice can now use this ID to see the current status of the transfer."),(0,o.kt)("admonition",{type:"tip"},(0,o.kt)("p",{parentName:"admonition"},"Make sure to replace ",(0,o.kt)("inlineCode",{parentName:"p"},"<ID>")," in the URL with the UUID you just received.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location 'http://localhost/alice/management/v2/transferprocesses/<ID>' \\\n--header 'X-Api-Key: password' | jq\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"If the transfer was ",(0,o.kt)("strong",{parentName:"li"},"successful"),", Alice will see an ouput as shown below."),(0,o.kt)("li",{parentName:"ul"},"If the transfer was ",(0,o.kt)("strong",{parentName:"li"},"unsuccessful"),", the transfer state (",(0,o.kt)("inlineCode",{parentName:"li"},"edc:state"),") will be ",(0,o.kt)("inlineCode",{parentName:"li"},"TERMINATED"),".")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "@id": "6d6bca4e-4da5-4ed3-9fe5-2b98623d9a59",\n  "@type": "edc:TransferProcess",\n  "edc:correlationId": "6d6bca4e-4da5-4ed3-9fe5-2b98623d9a59",\n  "edc:state": "STARTED",\n  "edc:stateTimestamp": 1702990026966,\n  "edc:type": "CONSUMER",\n  "edc:assetId": "3",\n  "edc:contractId": "Mw==:Mw==:NmY5MDA4OGEtOWY1ZC00YmYyLWFiZjMtMjRiNzY0YzEyOTk4",\n  "edc:callbackAddresses": [],\n  "edc:dataDestination": {\n    "@type": "edc:DataAddress",\n    "edc:type": "HttpProxy"\n  },\n  "edc:connectorId": "BPNL000000000002",\n  "@context": {\n    "dct": "https://purl.org/dc/terms/",\n    "tx": "https://w3id.org/tractusx/v0.0.1/ns/",\n    "edc": "https://w3id.org/edc/v0.0.1/ns/",\n    "dcat": "https://www.w3.org/ns/dcat/",\n    "odrl": "http://www.w3.org/ns/odrl/2/",\n    "dspace": "https://w3id.org/dspace/v0.8/"\n  }\n}\n')),(0,o.kt)("p",null,"The response shows her that she has a ",(0,o.kt)("inlineCode",{parentName:"p"},"STARTED")," transfer with the type ",(0,o.kt)("inlineCode",{parentName:"p"},"CONSUMER")," of the asset with the ID ",(0,o.kt)("inlineCode",{parentName:"p"},"3"),".\nNote, that a consumer pull transfer will ",(0,o.kt)("strong",{parentName:"p"},"not")," advance to the ",(0,o.kt)("inlineCode",{parentName:"p"},"COMPLETED")," state, but instead will stay in state ",(0,o.kt)("inlineCode",{parentName:"p"},"STARTED"),".\nThis means, that Alice can now request the data using the information received by her backend."),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"If you used webhook.site as your backend system, you can now go to ",(0,o.kt)("a",{parentName:"p",href:"https://webhook.site/"},"webhook.site")," and see the received token.")),(0,o.kt)("h2",{id:"consume-the-data"},"Consume the data"),(0,o.kt)("p",null,"In her backend (as already mentioned ",(0,o.kt)("a",{parentName:"p",href:"https://webhook.site/"},"webhook.site"),") you will now find the following (as an example) entry"),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Consume data backend",src:n(11421).Z,width:"3840",height:"1402"})),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "id": "841e3cd7-add0-47fd-adef-ea8074ec50af",\n  "endpoint": "http://bob-tractusx-connector-dataplane:8081/api/public",\n  "authKey": "Authorization",\n  "authCode": "eyJhbGciOiJFUzI1NiJ9.eyJleHAiOjE3MTE5MTIzMDgsImRhZCI6IktaamRBV3ZSV0xpS3V5akNwSjRIdEgwT2lqOEdQRno2SVdXcWxMMEFFZUloS25wOU5mZll2R1Q0M0N4dURZVHhUK3lRaXhrcWU1dVN1Sk5JR09GTi9kRlQ4R29WNGFHZ3FpdzhXMXBLT2ZLMUdtM1NkeFRIeWR0QTlnTnZoZFJ6T05RclpxbUlwNGxwZVBRaS9CSGVNTEYycEVsRVUvcExzU3dTbDh3eUplY3lSM2thTnJiUUw0a3RnajNMeDBjWUp3ZHZlS2h3OUdMYjF1UnBDa3I0RE5sOG4zQlprZ1ZEK1RYUGtIaGhXVWNpck1Tc3FBZHdyN3kvRFE0Nlp5S09GbldtTmVkdEVaempLWmRRRUlWMkcyV2d2cXFya25WdkNvTzhPZWpXZU1MaXUvdnl2cWdTZmp2dkk4cHhIOTRzYS90LzdGazB2YlRuMmpNMjQ3TFZQUlcvMk9wRElZWTA0dVRYY2p2T0h2L1UvcU5heURnR09uaitBbjcyZnNiOUZhWVZLMzQ4TzRYKzFDMkRvUjBwem9nQmJyRGMzSzRNQzBSdjcvVT0iLCJjaWQiOiJNdz09Ok13PT06WTJJelpHTXdaR1l0WVRNeVlpMDBZamM1TFdFNFkyTXROVE5rWWpVeU5tWXpNR0ZpIn0._2G-2eVzIQrTh-JW0Dx_P9nG2bAElPFllYtpN_s7MXk6R-F5jdMyCblMD6uJDw-H7J0SMiW5IAYExcZkMn-65w",\n  "properties": {}\n}\n')),(0,o.kt)("p",null,"Alice can now request the data using the provided information as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"curl -X GET -H '<authKey>: <authCode>' <endpoint>\n")),(0,o.kt)("admonition",{type:"warning"},(0,o.kt)("p",{parentName:"admonition"},"In this example, we can not use the endpoint URL as is, because we are working with a local Kubernetes cluster and can not use the cluster internal URL. Therefore, we have to use the ingress URL instead.")),(0,o.kt)("p",null,"In this example, this results in the following request:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"curl -X GET -H 'Authorization: eyJhbGciOiJFUzI1NiJ9.eyJleHAiOjE3MTE5MTIzMDgsImRhZCI6IktaamRBV3ZSV0xpS3V5akNwSjRIdEgwT2lqOEdQRno2SVdXcWxMMEFFZUloS25wOU5mZll2R1Q0M0N4dURZVHhUK3lRaXhrcWU1dVN1Sk5JR09GTi9kRlQ4R29WNGFHZ3FpdzhXMXBLT2ZLMUdtM1NkeFRIeWR0QTlnTnZoZFJ6T05RclpxbUlwNGxwZVBRaS9CSGVNTEYycEVsRVUvcExzU3dTbDh3eUplY3lSM2thTnJiUUw0a3RnajNMeDBjWUp3ZHZlS2h3OUdMYjF1UnBDa3I0RE5sOG4zQlprZ1ZEK1RYUGtIaGhXVWNpck1Tc3FBZHdyN3kvRFE0Nlp5S09GbldtTmVkdEVaempLWmRRRUlWMkcyV2d2cXFya25WdkNvTzhPZWpXZU1MaXUvdnl2cWdTZmp2dkk4cHhIOTRzYS90LzdGazB2YlRuMmpNMjQ3TFZQUlcvMk9wRElZWTA0dVRYY2p2T0h2L1UvcU5heURnR09uaitBbjcyZnNiOUZhWVZLMzQ4TzRYKzFDMkRvUjBwem9nQmJyRGMzSzRNQzBSdjcvVT0iLCJjaWQiOiJNdz09Ok13PT06WTJJelpHTXdaR1l0WVRNeVlpMDBZamM1TFdFNFkyTXROVE5rWWpVeU5tWXpNR0ZpIn0._2G-2eVzIQrTh-JW0Dx_P9nG2bAElPFllYtpN_s7MXk6R-F5jdMyCblMD6uJDw-H7J0SMiW5IAYExcZkMn-65w' http://localhost/bob/api/public\n")),(0,o.kt)("h2",{id:"notice"},"Notice"),(0,o.kt)("p",null,"This work is licensed under the ",(0,o.kt)("a",{parentName:"p",href:"https://creativecommons.org/licenses/by/4.0/legalcode"},"CC-BY-4.0"),"."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"SPDX-License-Identifier: CC-BY-4.0"),(0,o.kt)("li",{parentName:"ul"},"SPDX-FileCopyrightText: 2023 sovity GmbH"),(0,o.kt)("li",{parentName:"ul"},"SPDX-FileCopyrightText: 2023 SAP SE"),(0,o.kt)("li",{parentName:"ul"},"SPDX-FileCopyrightText: 2023 msg systems AG"),(0,o.kt)("li",{parentName:"ul"},"SPDX-FileCopyrightText: 2023 Materna Information & Communications SE"),(0,o.kt)("li",{parentName:"ul"},"Source URL: ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/eclipse-tractusx/eclipse-tractusx.github.io"},"https://github.com/eclipse-tractusx/eclipse-tractusx.github.io"))))}d.isMDXComponent=!0},11421:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/consume_data_backend-b6bd5b741bea592d18420d06786e5754.png"}}]);