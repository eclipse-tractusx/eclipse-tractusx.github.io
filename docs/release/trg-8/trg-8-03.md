---
title: TRG 8.03 - KICS
---

| Status | Created     | Post-History                         |
|--------|-------------|--------------------------------------|
| Active | 26-Feb-2024 | Initial release                      |

## Why

**KICS** identifies security vulnerabilities, compliance issues, and infrastructure misconfigurations in your IaC.

:::info

For any errors, please contact Security Team by creating an issue on GitHub.

:::

## Description

**KICS** is an integral tool in our security workflow, specifically targeting infrastructure-as-code (IaC) vulnerabilities. Here's how we've integrated KICS into our process:

:::info

When a push is made to the main branch or once daily (based on a CRON schedule), excluding markdown and text files, the KICS scan is triggered. Additionally, a manual dispatch option is available for on-demand scans.

:::

The job runs on the latest Ubuntu and requires permissions for reading actions and content, as well as writing security events. Upon initiation, the repository is checked out using the actions/checkout@v3 action.

The primary action involves running the KICS scan, which leverages the checkmarx/kics-github-action@v1.7.0. The scan focuses on the root directory, and the results are outputted in the SARIF format, stored in the kicsResults/ directory.

:::info

KICS is configured to exit with a status code of 0, regardless of the scan results, unless there's a KICS engine error. Some paths and specific queries are excluded from the scan, and secret scanning is explicitly disabled.

:::

Subsequently, the SARIF file, which contains the KICS scan results, is uploaded using the github/codeql-action/upload-sarif@v3 action. This ensures that the findings are made available for review and further analysis in the GitHub environment, aiding engineers in addressing potential vulnerabilities effectively.

:::info

We recommend for workflow to run with push. Schedule can be set up nightly or once per week.

:::

```md
/********************************************************************************
name: Run KICS scan and upload SARIF

on:
  push:
    branches: main
    paths-ignore:
      - "**/*.md"
      - "**/*.txt"
  schedule:
    - cron: "0 0 * * *" # Once a day
  workflow_dispatch:

jobs:
  analyze:
    name: Analyze
    runs-on: ubuntu-latest
    permissions:
      actions: read
      contents: read
      security-events: write

    steps:
      - name: Checkout repo
        uses: actions/checkout@v4

      - name: Run KICS Scan with SARIF result
        uses: checkmarx/kics-github-action@v1.7.0
        with:
          # Scanning directory .
          path: "."
          # When provided with a directory on output_path
          # it will generate the specified reports file named 'results.{extension}'
          # in this example it will generate: kicsResults/results.sarif
          output_path: kicsResults/
          output_formats: "sarif"
          # If you want KICS to ignore the results and return exit status code 0 unless a KICS engine error happens
          ignore_on_exit: results
          # Exclude paths or files from scan
          # exclude_paths: "terraform/gcp/big_data.tf,terraform/azure"
          # Exclude accepted queries from the build
          # exclude_queries: 0437633b-daa6-4bbc-8526-c0d2443b946e
          # No secret scanning
          disable_secrets: true

      - name: Upload SARIF file
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: kicsResults/results.sarif
 ********************************************************************************/
 ```
